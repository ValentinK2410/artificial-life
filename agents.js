// –ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–≥–µ–Ω—Ç–∞–º–∏

class Agent {
    constructor(name, age, gender, type, ownerId = null) {
        // –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∞–≥–µ–Ω—Ç–∞
        this.name = name; // –ò–º—è –∞–≥–µ–Ω—Ç–∞ (—Å—Ç—Ä–æ–∫–∞)
        this.age = age; // –í–æ–∑—Ä–∞—Å—Ç –∞–≥–µ–Ω—Ç–∞ (—á–∏—Å–ª–æ, –ª–µ—Ç)
        this.gender = gender; // –ü–æ–ª –∞–≥–µ–Ω—Ç–∞ ('male' –∏–ª–∏ 'female')
        this.type = type; // –¢–∏–ø –∞–≥–µ–Ω—Ç–∞ ('man', 'woman', 'boy', 'girl', 'oldman', 'oldwoman')
        this.ownerId = ownerId; // ID –∏–≥—Ä–æ–∫–∞-–≤–ª–∞–¥–µ–ª—å—Ü–∞ (null = NPC, –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∏–≥—Ä–æ–∫—É)
        
        // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è –∏ –≤—ã–∂–∏–≤–∞–Ω–∏—è
        this.health = 100; // –ó–¥–æ—Ä–æ–≤—å–µ –∞–≥–µ–Ω—Ç–∞ (0-100, –ø—Ä–∏ 0 –∞–≥–µ–Ω—Ç —É–º–∏—Ä–∞–µ—Ç)
        this.energy = 100; // –≠–Ω–µ—Ä–≥–∏—è –∞–≥–µ–Ω—Ç–∞ (0-100, –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
        this.hunger = 0; // –ì–æ–ª–æ–¥ –∞–≥–µ–Ω—Ç–∞ (0-100, –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏ —Ç–µ—Ä—è–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤—å–µ)
        this.thirst = 0; // –ñ–∞–∂–¥–∞ –∞–≥–µ–Ω—Ç–∞ (0-100, –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–æ–¥–∞)
        this.sweetDesire = 0; // –ñ–µ–ª–∞–Ω–∏–µ —Å–ª–∞–¥–∫–æ–≥–æ (0-100, –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –≤ –µ–¥–µ)
        this.stamina = 100; // –í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –∞–≥–µ–Ω—Ç–∞ (0-100, –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ—Ç–µ—Ä—é —ç–Ω–µ—Ä–≥–∏–∏)
        this.immunity = 50; // –ò–º–º—É–Ω–∏—Ç–µ—Ç –∞–≥–µ–Ω—Ç–∞ (0-100, –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è–µ–º–æ—Å—Ç—å –±–æ–ª–µ–∑–Ω—è–º)
        this.appetite = 50; // –ê–ø–ø–µ—Ç–∏—Ç –∞–≥–µ–Ω—Ç–∞ (0-100, –≤–ª–∏—è–µ—Ç –Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –µ–¥—ã)
        this.temperature = 37; // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞ –∞–≥–µ–Ω—Ç–∞ (–≥—Ä–∞–¥—É—Å—ã –¶–µ–ª—å—Å–∏—è, –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è 37¬∞C)
        this.mood = 'neutral'; // –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ ('neutral', 'happy', 'sad', 'anxious')
        
        // –ü–æ–∑–∏—Ü–∏—è –∏ –¥–≤–∏–∂–µ–Ω–∏–µ
        this.position = { x: 0, y: 0 }; // –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã x, y)
        this.targetPosition = null; // –¶–µ–ª–µ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–º (null –∏–ª–∏ {x, y})
        this.isPlayerControlled = false; // –§–ª–∞–≥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–º (true = –∏–≥—Ä–æ–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç, false = –ò–ò —É–ø—Ä–∞–≤–ª—è–µ—Ç)
        this.id = 'agent_' + Date.now() + '_' + Math.random(); // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–≥–µ–Ω—Ç–∞
        this.lastEatTime = 0; // –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏ (timestamp, –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –µ–¥—ã)
        this.lastPosition = { x: 0, y: 0 }; // –ü—Ä–µ–¥—ã–¥—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è –∞–≥–µ–Ω—Ç–∞ (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –∏ —Ä–∞—Å—á–µ—Ç–∞ —Ç–µ–ø–ª–∞)
        
        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏ –ø–∞–º—è—Ç—å
        this.inventory = []; // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∞–≥–µ–Ω—Ç–∞ (–º–∞—Å—Å–∏–≤ –ø—Ä–µ–¥–º–µ—Ç–æ–≤: –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –æ–¥–µ–∂–¥–∞, —Ä–µ—Å—É—Ä—Å—ã, –¥–µ–Ω—å–≥–∏)
        this.memory = []; // –ü–∞–º—è—Ç—å –∞–≥–µ–Ω—Ç–∞ –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö (–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ {type, x, y})
        this.foodStorage = []; // –ó–∞–ø–∞—Å—ã –µ–¥—ã –¥–ª—è —Å–∞–º–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ {type, amount})
        this.animalFoodStorage = []; // –ó–∞–ø–∞—Å—ã –µ–¥—ã –¥–ª—è –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö (–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ {type, amount})
        this.pets = []; // –ú–∞—Å—Å–∏–≤ ID –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö –∞–≥–µ–Ω—Ç—É
        
        // –°–∏—Å—Ç–µ–º–∞ –æ–ø—ã—Ç–∞ (—Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã –æ–ø—ã—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤)
        this.experience = {
            saw: 0,           // –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –ø–∏–ª–æ–π (0-100)
            axe: 0,           // –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–ø–æ—Ä–æ–º (0-100)
            hammer: 0,        // –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –º–æ–ª–æ—Ç–∫–æ–º (0-100)
            pickaxe: 0,       // –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –∫–∏—Ä–∫–æ–π (0-100)
            shovel: 0,        // –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –ª–æ–ø–∞—Ç–æ–π (0-100)
            fishing: 0,       // –û–ø—ã—Ç —Ä—ã–±–∞–ª–∫–∏ (0-100)
            cooking: 0,       // –û–ø—ã—Ç –≥–æ—Ç–æ–≤–∫–∏ (0-100)
            building: 0,      // –û–ø—ã—Ç —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ (0-100)
            farming: 0,       // –û–ø—ã—Ç —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–∞ (0-100)
            hunting: 0,       // –û–ø—ã—Ç –æ—Ö–æ—Ç—ã (0-100)
            fire_building: 0, // –û–ø—ã—Ç —Ä–∞–∑–∂–∏–≥–∞–Ω–∏—è –∫–æ—Å—Ç—Ä–∞ (0-100)
            bring_wood: 0,    // –û–ø—ã—Ç –ø—Ä–∏–Ω–µ—Å–µ–Ω–∏—è –¥—Ä–æ–≤ –∫ –∫–æ—Å—Ç—Ä—É (0-100)
            gather_wood: 0,   // –û–ø—ã—Ç —Å–±–æ—Ä–∞ –¥—Ä–æ–≤ (0-100)
            gather_fish: 0,   // –û–ø—ã—Ç —Å–±–æ—Ä–∞ —Ä—ã–±—ã (0-100)
            gather_all: 0     // –û–ø—ã—Ç —Å–±–æ—Ä–∞ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (0-100)
        };
        
        // –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        this.fear = 0; // –£—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–∞—Ö–∞ –∞–≥–µ–Ω—Ç–∞ (0-100, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—Å—Ç—Ä–µ—á–µ —Å —Ö–∏—â–Ω–∏–∫–∞–º–∏)
        this.panic = false; // –§–ª–∞–≥ –ø–∞–Ω–∏–∫–∏ (true/false, –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º —Å—Ç—Ä–∞—Ö–µ)
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∞ (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞)
        this.state = 'explore'; // –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: 'explore', 'findFood', 'rest', 'sleep', 'findHeat', 'buildFire', 'defend', 'feedAnimal', 'playWithPet', 'storeFood', 'cook', 'hunt', 'build', 'fish', 'farm', 'moveToPoint', 'dead', 'heal'
        this.sleepStartTime = 0; // –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ —Å–Ω–∞ (timestamp, –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–Ω–∞)
        this.speed = 2; // –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞ (–ø–∏–∫—Å–µ–ª–µ–π –∑–∞ –∫–∞–¥—Ä)
        this.maxEnergy = 100; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –∞–≥–µ–Ω—Ç–∞ (–≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–µ–¥–µ–ª –¥–ª—è this.energy)
        this.maxHealth = 100; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –∞–≥–µ–Ω—Ç–∞ (–≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–µ–¥–µ–ª –¥–ª—è this.health)
        this.canBuildFire = false; // –§–ª–∞–≥ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è –∫–æ—Å—Ç—Ä–∞ (true = –º–æ–∂–µ—Ç —Ä–∞–∑–≤–æ–¥–∏—Ç—å –∫–æ—Å—Ç–µ—Ä)
        this.defenseSkill = 0; // –ù–∞–≤—ã–∫ –æ–±–æ—Ä–æ–Ω—ã –æ—Ç —Ö–∏—â–Ω–∏–∫–æ–≤ (—á–∏—Å–ª–æ, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±–æ—Ä–æ–Ω–µ)
        this.nearbyPredator = null; // –ë–ª–∏–∂–∞–π—à–∏–π —Ö–∏—â–Ω–∏–∫ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ (null –∏–ª–∏ –æ–±—ä–µ–∫—Ç {predator, distance})
        this.sickAgent = null; // –ë–æ–ª—å–Ω–æ–π –∞–≥–µ–Ω—Ç, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω—É–∂–Ω–æ –≤—ã–ª–µ—á–∏—Ç—å (–æ–±—ä–µ–∫—Ç Agent –∏–ª–∏ null)
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
        this.initializePosition();
    }

    initializePosition() {
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –Ω–∞ –∫–∞—Ä—Ç–µ
        if (window.world && window.world.canvas) {
            this.position.x = Math.random() * window.world.canvas.width;
            this.position.y = Math.random() * window.world.canvas.height;
        } else {
            this.position.x = 100 + Math.random() * 200;
            this.position.y = 100 + Math.random() * 200;
        }
    }

    update() {
        // –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç –º–µ—Ä—Ç–≤ - –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
        if (this.health <= 0) {
            this.state = 'dead';
            return;
        }
        
        // –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞
        const oldHunger = this.hunger; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–æ–ª–æ–¥–∞ (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const oldHealth = this.health; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        const oldTemperature = this.temperature; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        
        // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–æ–ª–æ–¥–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã, –∏–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
        const HUNGER_CONFIG = window.GAME_CONFIG?.AGENTS?.HUNGER || {
            INCREASE_RATE: 0.005,       // –°–∫–æ—Ä–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏—è –≥–æ–ª–æ–¥–∞ –∑–∞ –∫–∞–¥—Ä (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –±—ã–ª–æ 0.5, —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ!)
            CRITICAL_THRESHOLD: 85,     // –ü–æ—Ä–æ–≥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥–æ–ª–æ–¥–∞ (–ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ —Ç–µ—Ä—è–µ—Ç—Å—è –∑–¥–æ—Ä–æ–≤—å–µ)
            HEALTH_LOSS_RATE: 0.1,      // –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ç–µ—Ä–∏ –∑–¥–æ—Ä–æ–≤—å—è –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º –≥–æ–ª–æ–¥–µ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –±—ã–ª–æ 0.5, —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ!)
            AUTO_EAT_THRESHOLD: 50,     // –ü–æ—Ä–æ–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏ –∏–∑ –∑–∞–ø–∞—Å–æ–≤
            FOOD_RESTORE: 25,           // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–¥–∞, –∫–æ—Ç–æ—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –µ–¥–∞
            SEARCH_FOOD_THRESHOLD: 60,  // –ü–æ—Ä–æ–≥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∞–≥–µ–Ω—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç –∏—Å–∫–∞—Ç—å –µ–¥—É
            STORE_FOOD_THRESHOLD: 40,   // –ü–æ—Ä–æ–≥, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –∞–≥–µ–Ω—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç –∑–∞–ø–∞—Å–∞—Ç—å –µ–¥—É
            WARNING_THRESHOLD: 90       // –ü–æ—Ä–æ–≥ –¥–ª—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º –≥–æ–ª–æ–¥–µ
        };
        
        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≥–æ–ª–æ–¥
        this.hunger += HUNGER_CONFIG.INCREASE_RATE;
        if (this.hunger > 100) this.hunger = 100;
        
        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∂–∞–∂–¥—É (—É–º–µ–Ω—å—à–µ–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å)
        this.thirst += 0.01;
        if (this.thirst > 100) this.thirst = 100;
        
        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∂–µ–ª–∞–Ω–∏–µ —Å–ª–∞–¥–∫–æ–≥–æ
        this.sweetDesire += 0.02;
        if (this.sweetDesire > 100) this.sweetDesire = 100;
        
        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏ –ø—Ä–∏ –æ—Ç–¥—ã—Ö–µ
        if (this.state === 'rest') {
            this.stamina += 0.5;
            if (this.stamina > 100) this.stamina = 100;
        } else {
            // –£–º–µ–Ω—å—à–∞–µ–º –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            this.stamina -= 0.1;
            if (this.stamina < 0) this.stamina = 0;
        }
        
        // –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞ (–µ—Å–ª–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
        if (this.immunity > 50) {
            this.immunity -= 0.01; // –ú–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∫ –±–∞–∑–æ–≤–æ–º—É —É—Ä–æ–≤–Ω—é
        }
        
        // –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –∞–ø–ø–µ—Ç–∏—Ç–∞ (–µ—Å–ª–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
        if (this.appetite > 50) {
            this.appetite -= 0.01;
        }
        
        // –£–º–µ–Ω—å—à–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏)
        const ENERGY_CONFIG = window.GAME_CONFIG?.AGENTS?.ENERGY || {
            BASE_LOSS_RATE: 0.05,              // –ë–∞–∑–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ç–µ—Ä–∏ —ç–Ω–µ—Ä–≥–∏–∏ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–∑–∞ –∫–∞–¥—Ä)
            REST_RESTORE_RATE: 0.5,            // –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –ø—Ä–∏ –æ—Ç–¥—ã—Ö–µ (–∑–∞ –∫–∞–¥—Ä)
            LOW_ENERGY_THRESHOLD: 30,          // –ü–æ—Ä–æ–≥ –Ω–∏–∑–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏ (–∫–æ–≥–¥–∞ –∞–≥–µ–Ω—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç –æ—Ç–¥—ã—Ö–∞—Ç—å)
            CRITICAL_ENERGY_THRESHOLD: 20,     // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥ —ç–Ω–µ—Ä–≥–∏–∏ (–∫–æ–≥–¥–∞ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç—Å—è)
            STAMINA_REDUCTION_FACTOR: 0.5      // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ—Ç–µ—Ä—å —ç–Ω–µ—Ä–≥–∏–∏ –æ—Ç –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏ (0-1)
        };
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–Ω–∞
        const SLEEP_CONFIG = window.GAME_CONFIG?.AGENTS?.SLEEP || {
            ENERGY_RESTORE_RATE: 1.5,          // –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –≤–æ —Å–Ω–µ (–∑–∞ –∫–∞–¥—Ä, –±—ã—Å—Ç—Ä–µ–µ —á–µ–º –æ—Ç–¥—ã—Ö)
            HEALTH_RESTORE_RATE: 0.1,          // –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è –≤–æ —Å–Ω–µ (–∑–∞ –∫–∞–¥—Ä)
            STAMINA_RESTORE_RATE: 1.0,         // –°–∫–æ—Ä–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏ –≤–æ —Å–Ω–µ (–∑–∞ –∫–∞–¥—Ä)
            MIN_SLEEP_DURATION: 100,           // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∞ (–≤ –∫–∞–¥—Ä–∞—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
            AUTO_SLEEP_ENERGY_THRESHOLD: 20,   // –ü–æ—Ä–æ–≥ —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞—Å—ã–ø–∞–Ω–∏—è
            AUTO_SLEEP_NIGHT: true             // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞—Å—ã–ø–∞–Ω–∏–µ –Ω–æ—á—å—é (true/false)
        };
        
        if (this.state === 'sleep') {
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é, –∑–¥–æ—Ä–æ–≤—å–µ –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –≤–æ —Å–Ω–µ
            this.energy += SLEEP_CONFIG.ENERGY_RESTORE_RATE;
            if (this.energy > this.maxEnergy) this.energy = this.maxEnergy;
            
            this.health += SLEEP_CONFIG.HEALTH_RESTORE_RATE;
            if (this.health > this.maxHealth) this.health = this.maxHealth;
            
            this.stamina += SLEEP_CONFIG.STAMINA_RESTORE_RATE;
            if (this.stamina > 100) this.stamina = 100;
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ —ç–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ –ø—Ä–æ—à–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏
            const currentTime = Date.now(); // –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
            const sleepDuration = currentTime - (this.sleepStartTime || currentTime); // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
            const minSleepDurationMs = SLEEP_CONFIG.MIN_SLEEP_DURATION * 16; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–Ω–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö (–ø—Ä–∏–º–µ—Ä–Ω–æ 16–º—Å –Ω–∞ –∫–∞–¥—Ä)
            
            if (this.energy >= 90 && sleepDuration >= minSleepDurationMs) {
                // –ü—Ä–æ–±—É–∂–¥–∞–µ–º—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                this.state = 'explore';
                this.sleepStartTime = 0;
                if (this.lastSleepTime) {
                    this.lastSleepTime = 0;
                }
                if (window.addLogEntry) {
                    window.addLogEntry(`‚òÄÔ∏è ${this.name} –ø—Ä–æ—Å–Ω—É–ª—Å—è –æ—Ç–¥–æ—Ö–Ω—É–≤—à–∏–º`);
                }
            }
        } else if (this.state === 'rest') {
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é –ø—Ä–∏ –æ—Ç–¥—ã—Ö–µ
            this.energy += ENERGY_CONFIG.REST_RESTORE_RATE;
            if (this.energy > this.maxEnergy) this.energy = this.maxEnergy;
        } else {
            // –£–º–µ–Ω—å—à–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            // –ß–µ–º –±–æ–ª—å—à–µ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å, —Ç–µ–º –º–µ–Ω—å—à–µ –ø–æ—Ç–µ—Ä–∏ —ç–Ω–µ—Ä–≥–∏–∏
            // –§–æ—Ä–º—É–ª–∞: –±–∞–∑–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏ * (1 - –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å/100 * –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç)
            const staminaReduction = (this.stamina / 100) * ENERGY_CONFIG.STAMINA_REDUCTION_FACTOR; // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ—Ç–µ—Ä—å –æ—Ç –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏ (0-0.5)
            const energyLoss = ENERGY_CONFIG.BASE_LOSS_RATE * (1 - staminaReduction); // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ—Ç–µ—Ä—è —ç–Ω–µ—Ä–≥–∏–∏ —Å —É—á–µ—Ç–æ–º –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç–∏
            this.energy -= energyLoss;
            if (this.energy < 0) this.energy = 0;
        }
        
        // –°–∏—Å—Ç–µ–º–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Ç–µ–ø–ª–∞
        this.updateTemperature();
        
        // –ü–æ–ª—É—á–∞–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Å–º–µ—Ä—Ç–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
        const DEATH_TEMPERATURE = window.GAME_CONFIG?.AGENTS?.DEATH_TEMPERATURE || 28; // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å–º–µ—Ä—Ç–∏ –æ—Ç –ø–µ—Ä–µ–æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è (¬∞C)
        
        // –ï—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–∞—è - –∞–≥–µ–Ω—Ç —É–º–∏—Ä–∞–µ—Ç –æ—Ç –ø–µ—Ä–µ–æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
        if (this.temperature < DEATH_TEMPERATURE && this.health > 0) {
            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Å–ª–µ —Å–º–µ—Ä—Ç–∏
            const TEMP_CONFIG = window.GAME_CONFIG?.AGENTS?.TEMPERATURE || {
                AMBIENT_TEMP: { DEFAULT: 20, SUNNY: 25, CLOUDY: 18, RAIN: 10, NIGHT: 5 }
            };
            let ambientTemp = TEMP_CONFIG.AMBIENT_TEMP.DEFAULT;
            if (window.world) {
                const weather = window.world.weather || 'sunny';
                const timeOfDay = window.world.timeOfDay || 'day';
                if (weather === 'night' || timeOfDay === 'night') {
                    ambientTemp = TEMP_CONFIG.AMBIENT_TEMP.NIGHT;
                } else {
                    ambientTemp = TEMP_CONFIG.AMBIENT_TEMP[weather.toUpperCase()] || TEMP_CONFIG.AMBIENT_TEMP.DEFAULT;
                }
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Ä–∞–≤–Ω–æ–π –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥–µ –∏ —É–±–∏–≤–∞–µ–º –∞–≥–µ–Ω—Ç–∞
            this.temperature = ambientTemp;
            this.health = 0;
            this.state = 'dead';
            
            if (window.addLogEntry) {
                window.addLogEntry(`üíÄ ${this.name} –ø–æ–≥–∏–± –æ—Ç –ø–µ—Ä–µ–æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞: ${Math.floor(ambientTemp)}¬∞C`);
            }
            
            // –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞
            return;
        }
        
        // –ï—Å–ª–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è, —Ç–µ—Ä—è–µ–º –∑–¥–æ—Ä–æ–≤—å–µ (—É–º–µ–Ω—å—à–µ–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ç–µ—Ä–∏)
        if (this.temperature < 35) {
            const healthLoss = (35 - this.temperature) * 0.02; // –ü–æ—Ç–µ—Ä—è –∑–¥–æ—Ä–æ–≤—å—è –æ—Ç —Ö–æ–ª–æ–¥–∞ (—É–º–µ–Ω—å—à–µ–Ω–æ —Å 0.1 –¥–æ 0.02 –¥–ª—è –±–∞–ª–∞–Ω—Å–∞)
            this.health -= healthLoss;
            if (this.health < 0) this.health = 0;
        }
        
        // –ï—Å–ª–∏ –≥–æ–ª–æ–¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π, –Ω–∞—á–∏–Ω–∞–µ–º —Ç–µ—Ä—è—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ
        if (this.hunger > HUNGER_CONFIG.CRITICAL_THRESHOLD) {
            this.health -= HUNGER_CONFIG.HEALTH_LOSS_RATE; // –ü–æ—Ç–µ—Ä—è –∑–¥–æ—Ä–æ–≤—å—è –æ—Ç –≥–æ–ª–æ–¥–∞
            if (this.health < 0) this.health = 0;
        }
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–ø–∞—Å—ã –µ–¥—ã –µ—Å–ª–∏ –≥–æ–ª–æ–¥–Ω—ã –∏–ª–∏ —Ö–æ—Ç–∏–º –ø–∏—Ç—å
        if ((this.hunger > HUNGER_CONFIG.AUTO_EAT_THRESHOLD || this.thirst > 60) && this.foodStorage.length > 0) {
            // –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â—É—é –µ–¥—É
            let foodToEat = null; // –ù–∞–π–¥–µ–Ω–Ω–∞—è –µ–¥–∞ –¥–ª—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è (–æ–±—ä–µ–∫—Ç {type, amount} –∏–ª–∏ null)
            let foodIndex = -1; // –ò–Ω–¥–µ–∫—Å –Ω–∞–π–¥–µ–Ω–Ω–æ–π –µ–¥—ã –≤ –º–∞—Å—Å–∏–≤–µ foodStorage
            
            if (this.thirst > 60) {
                // –ò—â–µ–º –Ω–∞–ø–∏—Ç–∫–∏
                foodToEat = this.foodStorage.find((f, i) => {
                    const props = window.FOOD_PROPERTIES?.[f.type];
                    if (props && props.thirst) {
                        foodIndex = i;
                        return true;
                    }
                    return false;
                });
            }
            
            if (!foodToEat) {
                // –ò—â–µ–º –ª—é–±—É—é –µ–¥—É
                foodToEat = this.foodStorage[0];
                foodIndex = 0;
            }
            
            if (foodToEat) {
                this.consumeFood(foodToEat.type);
                foodToEat.amount--;
                if (foodToEat.amount <= 0) {
                    this.foodStorage.splice(foodIndex, 1);
                }
                if (window.addLogEntry && Math.random() < 0.1) {
                    window.addLogEntry(`üçΩÔ∏è ${this.name} –µ—Å—Ç –∏–∑ –∑–∞–ø–∞—Å–æ–≤: ${this.getFoodName(foodToEat.type)}`);
                }
            }
        }
        
        // –ï—Å–ª–∏ —ç–Ω–µ—Ä–≥–∏—è < 20, —Å–Ω–∏–∂–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å
        if (this.energy < 20) {
            this.speed = 1;
        } else {
            this.speed = 2;
        }
        
        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
        if (window.addLogEntry) {
            // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –≥–æ–ª–æ–¥
            const WARNING_THRESHOLD = window.GAME_CONFIG?.AGENTS?.HUNGER?.WARNING_THRESHOLD || 90;
            if (this.hunger > WARNING_THRESHOLD && oldHunger <= WARNING_THRESHOLD) {
                window.addLogEntry(`‚ö†Ô∏è ${this.name} –æ—á–µ–Ω—å –≥–æ–ª–æ–¥–µ–Ω!`);
            }
            // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
            if (this.temperature < 35 && oldTemperature >= 35) {
                window.addLogEntry(`‚ùÑÔ∏è ${this.name} –∑–∞–º–µ—Ä–∑–∞–µ—Ç!`);
            }
            if (this.temperature < 32 && oldTemperature >= 32) {
                window.addLogEntry(`ü•∂ ${this.name} —Å–∏–ª—å–Ω–æ –∑–∞–º–µ—Ä–∑–∞–µ—Ç!`);
            }
            // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ
            if (this.health < 20 && oldHealth >= 20) {
                window.addLogEntry(`‚ö†Ô∏è ${this.name} –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏!`);
            }
            // –°–º–µ—Ä—Ç—å (–µ—Å–ª–∏ –∑–¥–æ—Ä–æ–≤—å–µ —É–ø–∞–ª–æ –¥–æ 0)
            if (this.health <= 0 && oldHealth > 0) {
                const cause = this.temperature < 32 ? '–æ—Ç –ø–µ—Ä–µ–æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è' : '–æ—Ç –≥–æ–ª–æ–¥–∞ –∏ –∏—Å—Ç–æ—â–µ–Ω–∏—è';
                window.addLogEntry(`üíÄ ${this.name} –ø–æ–≥–∏–± ${cause}`);
            }
        }
        
        // –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π - –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –∏–≥—Ä–æ–∫ –Ω–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≥–µ–Ω—Ç–æ–º
        if (!this.isPlayerControlled || !this.targetPosition) {
            this.decide();
        } else {
            // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –∫ —Ü–µ–ª–∏
            this.state = 'moveToPoint';
            // –í–´–ó–´–í–ê–ï–ú act() –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è –∫ —Ü–µ–ª–∏
            this.act();
        }
        
        // –ï—Å–ª–∏ decide() –±—ã–ª –≤—ã–∑–≤–∞–Ω, act() —É–∂–µ –≤—ã–∑–≤–∞–Ω –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ
        // –ù–æ –µ—Å–ª–∏ decide() –Ω–µ –±—ã–ª –≤—ã–∑–≤–∞–Ω (–∏–≥—Ä–æ–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç), act() —É–∂–µ –≤—ã–∑–≤–∞–Ω –≤—ã—à–µ
        
        // –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –º–∏—Ä–æ–º (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏–≥—Ä–æ–∫–∞)
        if (window.world && (!this.isPlayerControlled || !this.targetPosition)) {
            this.interactWithWorld(window.world);
            this.interactWithAnimals(window.world);
        }
    }
    
    interactWithAnimals(world) {
        // –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏ (–ø—Ä–∏—Ä—É—á–µ–Ω–∏–µ, –∫–æ—Ä–º–ª–µ–Ω–∏–µ)
        if (!world.animals) return;
        
        world.animals.forEach(animal => {
            const dx = animal.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–æ–º –∏ –∂–∏–≤–æ—Ç–Ω—ã–º
            const dy = animal.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–æ–º –∏ –∂–∏–≤–æ—Ç–Ω—ã–º
            const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
            
            // –ï—Å–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–µ –±–ª–∏–∑–∫–æ –∏ –Ω–µ –ø—Ä–∏—Ä—É—á–µ–Ω–æ
            if (distance < 25 && !animal.tamed && !animal.owner) {
                // –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–∏—Ä—É—á–µ–Ω–∏—è (—Å—Ç–∞—Ä–∏–∫–∏ –±–æ–ª–µ–µ —É—Å–ø–µ—à–Ω—ã)
                const tamingChance = this.age > 60 ? 0.3 : (this.age > 30 ? 0.15 : 0.05); // –®–∞–Ω—Å –ø—Ä–∏—Ä—É—á–µ–Ω–∏—è (0-1, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞)
                
                if (Math.random() < tamingChance) {
                    animal.tamed = true; // –ü–æ–º–µ—á–∞–µ–º –∂–∏–≤–æ—Ç–Ω–æ–µ –∫–∞–∫ –ø—Ä–∏—Ä—É—á–µ–Ω–Ω–æ–µ
                    animal.owner = this.type; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞
                    this.pets.push(animal.id); // –î–æ–±–∞–≤–ª—è–µ–º ID –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –≤ —Å–ø–∏—Å–æ–∫ –ø–∏—Ç–æ–º—Ü–µ–≤
                    
                    this.gainExperience('farming', 2);
                    
                    if (window.addLogEntry) {
                        window.addLogEntry(`üêæ ${this.name} –ø—Ä–∏—Ä—É—á–∏–ª ${world.getAnimalName(animal.type)}!`);
                    }
                }
            }
            
            // –ï—Å–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–µ –Ω–∞—à–µ –∏ –≥–æ–ª–æ–¥–Ω–æ–µ - –∫–æ—Ä–º–∏–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            if (animal.owner === this.type && animal.hunger > 70 && distance < 20) {
                const food = this.animalFoodStorage.find(f => f.amount > 0); // –ù–∞—Ö–æ–¥–∏–º –µ–¥—É –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö –≤ –∑–∞–ø–∞—Å–∞—Ö
                if (food) {
                    animal.hunger -= 25; // –£–º–µ–Ω—å—à–∞–µ–º –≥–æ–ª–æ–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ
                    if (animal.hunger < 0) animal.hunger = 0;
                    food.amount--; // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥—ã
                    if (food.amount <= 0) {
                        const index = this.animalFoodStorage.indexOf(food); // –ò–Ω–¥–µ–∫—Å –µ–¥—ã –≤ –º–∞—Å—Å–∏–≤–µ –∑–∞–ø–∞—Å–æ–≤
                        if (index > -1) this.animalFoodStorage.splice(index, 1); // –£–¥–∞–ª—è–µ–º –ø—É—Å—Ç—É—é –µ–¥—É
                    }
                }
            }
        });
    }
    
    checkForSickAgents() {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –±–æ–ª—å–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ (–∑–¥–æ—Ä–æ–≤—å–µ < 30)
        this.sickAgent = null; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
        if (!window.agents || !window.agents.getAllAgents) return;
        
        const allAgents = window.agents.getAllAgents(); // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
        const CRITICAL_HEALTH_THRESHOLD = 30; // –ü–æ—Ä–æ–≥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è (–Ω–∏–∂–µ —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∞–≥–µ–Ω—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –±–æ–ª—å–Ω—ã–º)
        
        let minDistance = Infinity; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (–ø–∏–∫—Å–µ–ª–∏, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å)
        
        allAgents.forEach(agent => {
            // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–µ–±—è –∏ –º–µ—Ä—Ç–≤—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
            if (agent.id === this.id || agent.health <= 0 || agent.state === 'dead') return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∞–≥–µ–Ω—Ç —Å–∏–ª—å–Ω–æ –±–æ–ª–µ–Ω (–∑–¥–æ—Ä–æ–≤—å–µ < 30)
            if (agent.health < CRITICAL_HEALTH_THRESHOLD) {
                const dx = agent.position.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (–ø–∏–∫—Å–µ–ª–∏)
                const dy = agent.position.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (–ø–∏–∫—Å–µ–ª–∏)
                const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (–ø–∏–∫—Å–µ–ª–∏)
                
                // –ï—Å–ª–∏ –±–æ–ª—å–Ω–æ–π –∞–≥–µ–Ω—Ç –≤ —Ä–∞–¥–∏—É—Å–µ 100 –ø–∏–∫—Å–µ–ª–µ–π –∏ –±–ª–∏–∂–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
                if (distance < 100 && distance < minDistance) {
                    minDistance = distance; // –û–±–Ω–æ–≤–ª—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
                    this.sickAgent = agent; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
                }
            }
        });
    }
    
    hasMedicalSupplies() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –∞–≥–µ–Ω—Ç–∞ –∞–ø—Ç–µ—á–∫–∞ –∏ –ª–µ—á–µ–±–Ω—ã–µ —Ç—Ä–∞–≤—ã
        const hasFirstAidKit = this.inventory.some(item => item.type === 'first_aid_kit'); // –§–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è –∞–ø—Ç–µ—á–∫–∏ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (true/false)
        
        if (!hasFirstAidKit) {
            return false; // –ë–µ–∑ –∞–ø—Ç–µ—á–∫–∏ –Ω–µ–ª—å–∑—è –ª–µ—á–∏—Ç—å
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ª–µ—á–µ–±–Ω—ã—Ö —Ç—Ä–∞–≤ (—à–∏–ø–æ–≤–Ω–∏–∫, –∑–≤–µ—Ä–æ–±–æ–π, –º—è—Ç–∞, –ª–∏–º–æ–Ω)
        const healingHerbs = ['rosehip', 'st_johns_wort', 'mint', 'lemon', 'honey']; // –ú–∞—Å—Å–∏–≤ —Ç–∏–ø–æ–≤ –ª–µ—á–µ–±–Ω—ã—Ö —Ç—Ä–∞–≤
        const hasHerbs = this.inventory.some(item => healingHerbs.includes(item.type)); // –§–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è –ª–µ—á–µ–±–Ω—ã—Ö —Ç—Ä–∞–≤ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (true/false)
        
        return hasHerbs; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º true, –µ—Å–ª–∏ –µ—Å—Ç—å –∏ –∞–ø—Ç–µ—á–∫–∞, –∏ —Ç—Ä–∞–≤—ã
    }
    
    heal() {
        // –õ–µ—á–µ–Ω–∏–µ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
        if (!this.sickAgent || this.sickAgent.health <= 0) {
            // –ù–µ—Ç –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –∏–ª–∏ –æ–Ω —É–∂–µ –º–µ—Ä—Ç–≤
            this.state = 'explore';
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–µ–π
        if (!this.hasMedicalSupplies()) {
            // –ù–µ—Ç –∞–ø—Ç–µ—á–∫–∏ –∏–ª–∏ –ª–µ—á–µ–±–Ω—ã—Ö —Ç—Ä–∞–≤
            if (window.addLogEntry && Math.random() < 0.2) {
                window.addLogEntry(`üíä ${this.name} –Ω—É–∂–Ω–∞ –∞–ø—Ç–µ—á–∫–∞ –∏ –ª–µ—á–µ–±–Ω—ã–µ —Ç—Ä–∞–≤—ã –¥–ª—è –ª–µ—á–µ–Ω–∏—è`);
            }
            this.state = 'explore';
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
        const dx = this.sickAgent.position.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (–ø–∏–∫—Å–µ–ª–∏)
        const dy = this.sickAgent.position.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (–ø–∏–∫—Å–µ–ª–∏)
        const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (–ø–∏–∫—Å–µ–ª–∏)
        
        if (distance > 30) {
            // –î–∞–ª–µ–∫–æ –æ—Ç –±–æ–ª—å–Ω–æ–≥–æ - –∏–¥–µ–º –∫ –Ω–µ–º—É
            this.moveTo(this.sickAgent.position.x, this.sickAgent.position.y);
            return;
        }
        
        // –†—è–¥–æ–º —Å –±–æ–ª—å–Ω—ã–º - –ª–µ—á–∏–º
        if (!this.healingProgress) {
            this.healingProgress = 0; // –ü—Ä–æ–≥—Ä–µ—Å—Å –ª–µ—á–µ–Ω–∏—è (—á–∏—Å–ª–æ –∫–∞–¥—Ä–æ–≤, 0 = –Ω–∞—á–∞–ª–æ –ª–µ—á–µ–Ω–∏—è)
        }
        
        this.healingProgress += 1; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ª–µ—á–µ–Ω–∏—è
        
        // –õ–µ—á–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è (10-15 –∫–∞–¥—Ä–æ–≤)
        const healingTime = 15; // –í—Ä–µ–º—è –ª–µ—á–µ–Ω–∏—è –≤ –∫–∞–¥—Ä–∞—Ö
        if (this.healingProgress < healingTime) {
            // –ï—â–µ –ª–µ—á–∏–º
            return;
        }
        
        // –õ–µ—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–µ—á–µ–±–Ω—ã–µ —Ç—Ä–∞–≤—ã
        const healingHerbs = ['rosehip', 'st_johns_wort', 'mint', 'lemon', 'honey']; // –ú–∞—Å—Å–∏–≤ —Ç–∏–ø–æ–≤ –ª–µ—á–µ–±–Ω—ã—Ö —Ç—Ä–∞–≤
        const herbItem = this.inventory.find(item => healingHerbs.includes(item.type)); // –ù–∞–π–¥–µ–Ω–Ω–∞—è –ª–µ—á–µ–±–Ω–∞—è —Ç—Ä–∞–≤–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (–æ–±—ä–µ–∫—Ç {type, amount} –∏–ª–∏ undefined)
        
        if (herbItem) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç—Ä–∞–≤—É –¥–ª—è –ª–µ—á–µ–Ω–∏—è
            const FOOD_PROPERTIES = window.FOOD_PROPERTIES || {}; // –û–±—ä–µ–∫—Ç —Å–æ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –µ–¥—ã
            const props = FOOD_PROPERTIES[herbItem.type]; // –°–≤–æ–π—Å—Ç–≤–∞ –ª–µ—á–µ–±–Ω–æ–π —Ç—Ä–∞–≤—ã (–æ–±—ä–µ–∫—Ç {health, immunity, ...} –∏–ª–∏ undefined)
            
            if (props) {
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
                const healthRestore = props.health || 0; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è
                const immunityRestore = props.immunity || 0; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–æ–≥–æ –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞
                
                this.sickAgent.health = Math.min(100, this.sickAgent.health + healthRestore); // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–¥–æ—Ä–æ–≤—å–µ (–Ω–µ –≤—ã—à–µ 100)
                if (immunityRestore > 0) {
                    this.sickAgent.immunity = Math.min(100, this.sickAgent.immunity + immunityRestore); // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º–º—É–Ω–∏—Ç–µ—Ç (–Ω–µ –≤—ã—à–µ 100)
                }
                
                // –£–±–∏—Ä–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é —Ç—Ä–∞–≤—É –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                herbItem.amount--; // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–≤—ã
                if (herbItem.amount <= 0) {
                    const index = this.inventory.indexOf(herbItem); // –ò–Ω–¥–µ–∫—Å —Ç—Ä–∞–≤—ã –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
                    if (index > -1) this.inventory.splice(index, 1); // –£–¥–∞–ª—è–µ–º —Ç—Ä–∞–≤—É –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                }
                
                // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç –ª–µ—á–µ–Ω–∏—è
                this.gainExperience('healing', 3); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç –ª–µ—á–µ–Ω–∏—è (–µ—Å–ª–∏ —Ç–∞–∫–æ–π –Ω–∞–≤—ã–∫ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω)
                
                if (window.addLogEntry) {
                    window.addLogEntry(`üíä ${this.name} –≤—ã–ª–µ—á–∏–ª(–∞) ${this.sickAgent.name} –∏—Å–ø–æ–ª—å–∑—É—è ${this.getFoodName(herbItem.type)}. –ó–¥–æ—Ä–æ–≤—å–µ: ${Math.floor(this.sickAgent.health)}%`);
                }
            }
        }
        
        this.healingProgress = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ª–µ—á–µ–Ω–∏—è
        this.sickAgent = null; // –û—á–∏—â–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
        this.state = 'explore'; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –æ–±—ã—á–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é
    }

    updateTemperature() {
        // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
        const TEMP_CONFIG = window.GAME_CONFIG?.AGENTS?.TEMPERATURE || {
            AMBIENT_TEMP: {
                SUNNY: 25,      // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –≤ —Å–æ–ª–Ω–µ—á–Ω—É—é –ø–æ–≥–æ–¥—É (¬∞C)
                CLOUDY: 18,    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –≤ –æ–±–ª–∞—á–Ω—É—é –ø–æ–≥–æ–¥—É (¬∞C)
                RAIN: 10,      // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –≤ –¥–æ–∂–¥—å (¬∞C)
                NIGHT: 5,      // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –Ω–æ—á—å—é (¬∞C)
                DEFAULT: 20    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (¬∞C)
            },
            TEMP_CHANGE_RATE: 0.05,        // –°–∫–æ—Ä–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Ç–µ–ª–∞ (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–ª–∞–≤–Ω–æ—Å—Ç–∏)
            FIRE_HEAT_BONUS: 25,           // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å —Ç–µ–ø–ª–∞ –æ—Ç –∫–æ—Å—Ç—Ä–∞ (¬∞C)
            FIRE_RADIUS: 80,               // –†–∞–¥–∏—É—Å –¥–µ–π—Å—Ç–≤–∏—è —Ç–µ–ø–ª–∞ –æ—Ç –∫–æ—Å—Ç—Ä–∞ (–ø–∏–∫—Å–µ–ª–∏)
            MIN_AMBIENT_TEMP: 20,          // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã (¬∞C)
            MOVEMENT_HEAT_BONUS: 5,        // –ë–æ–Ω—É—Å —Ç–µ–ø–ª–∞ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ (¬∞C)
            MOVEMENT_THRESHOLD: 0.5        // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–Ω—É—Å–∞ —Ç–µ–ø–ª–∞ (–ø–∏–∫—Å–µ–ª–∏)
        };
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–≥–æ–¥—ã
        let ambientTemp = TEMP_CONFIG.AMBIENT_TEMP.DEFAULT; // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã (¬∞C)
        
        if (window.world) {
            const weather = window.world.weather || 'sunny'; // –¢–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞ ('sunny', 'cloudy', 'rain', 'night')
            const timeOfDay = window.world.timeOfDay || 'day'; // –í—Ä–µ–º—è —Å—É—Ç–æ–∫ ('day', 'night')
            
            // –ï—Å–ª–∏ –Ω–æ—á—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ—á–Ω—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
            if (weather === 'night' || timeOfDay === 'night') {
                ambientTemp = TEMP_CONFIG.AMBIENT_TEMP.NIGHT;
            } else {
                // –ò–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–≥–æ–¥—ã
                switch (weather) {
                    case 'sunny':
                        ambientTemp = TEMP_CONFIG.AMBIENT_TEMP.SUNNY;
                        break;
                    case 'cloudy':
                        ambientTemp = TEMP_CONFIG.AMBIENT_TEMP.CLOUDY;
                        break;
                    case 'rain':
                        ambientTemp = TEMP_CONFIG.AMBIENT_TEMP.RAIN;
                        break;
                    default:
                        ambientTemp = TEMP_CONFIG.AMBIENT_TEMP.DEFAULT;
                }
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–≤–∏–∂–µ—Ç—Å—è –ª–∏ –∞–≥–µ–Ω—Ç
        let movementBonus = 0; // –ë–æ–Ω—É—Å —Ç–µ–ø–ª–∞ –æ—Ç –¥–≤–∏–∂–µ–Ω–∏—è (¬∞C, 0 –∏–ª–∏ MOVEMENT_HEAT_BONUS)
        if (this.lastPosition && this.position) {
            const dx = this.position.x - this.lastPosition.x; // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ –æ—Å–∏ X (–ø–∏–∫—Å–µ–ª–∏)
            const dy = this.position.y - this.lastPosition.y; // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ –æ—Å–∏ Y (–ø–∏–∫—Å–µ–ª–∏)
            const distance = Math.sqrt(dx * dx + dy * dy); // –ü—Ä–æ–π–¥–µ–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–ø–∏–∫—Å–µ–ª–∏)
            
            // –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç –¥–≤–∏–∂–µ—Ç—Å—è (–ø—Ä–µ–æ–¥–æ–ª–µ–ª –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ), –¥–æ–±–∞–≤–ª—è–µ–º –±–æ–Ω—É—Å —Ç–µ–ø–ª–∞
            if (distance > TEMP_CONFIG.MOVEMENT_THRESHOLD) {
                movementBonus = TEMP_CONFIG.MOVEMENT_HEAT_BONUS; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ–Ω—É—Å —Ç–µ–ø–ª–∞ –æ—Ç –¥–≤–∏–∂–µ–Ω–∏—è
            }
        }
        
        // –ò—â–µ–º –±–ª–∏–∂–∞–π—à–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç–µ–ø–ª–∞ (–∫–æ—Å—Ç–µ—Ä)
        const nearestFire = this.findNearestFire(); // –ë–ª–∏–∂–∞–π—à–∏–π –∫–æ—Å—Ç–µ—Ä (–æ–±—ä–µ–∫—Ç {x, y, intensity, heatRadius} –∏–ª–∏ null)
        let heatBonus = 0; // –ë–æ–Ω—É—Å —Ç–µ–ø–ª–∞ –æ—Ç –∫–æ—Å—Ç—Ä–∞ (¬∞C)
        
        if (nearestFire) {
            const distance = Math.sqrt(
                Math.pow(nearestFire.x - this.position.x, 2) + 
                Math.pow(nearestFire.y - this.position.y, 2)
            ); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–æ—Å—Ç—Ä–∞ (–ø–∏–∫—Å–µ–ª–∏)
            // –¢–µ–ø–ª–æ –æ—Ç –∫–æ—Å—Ç—Ä–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
            const fireRadius = nearestFire.heatRadius || TEMP_CONFIG.FIRE_RADIUS; // –†–∞–¥–∏—É—Å –¥–µ–π—Å—Ç–≤–∏—è —Ç–µ–ø–ª–∞ –∫–æ—Å—Ç—Ä–∞ (–ø–∏–∫—Å–µ–ª–∏)
            if (distance < fireRadius) {
                const intensity = nearestFire.intensity || 1.0; // –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –∫–æ—Å—Ç—Ä–∞ (0-1, –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–ø–ª–∞)
                heatBonus = (fireRadius - distance) / fireRadius * TEMP_CONFIG.FIRE_HEAT_BONUS * intensity; // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –±–æ–Ω—É—Å —Ç–µ–ø–ª–∞ —Å —É—á–µ—Ç–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏
            }
        }
        
        // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ –æ–∫—Ä—É–∂–∞—é—â–µ–π + —Ç–µ–ø–ª–æ –æ—Ç –∫–æ—Å—Ç—Ä–∞ + –±–æ–Ω—É—Å –æ—Ç –¥–≤–∏–∂–µ–Ω–∏—è
        // –ü—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–µ –º–æ–∂–µ—Ç –ø–æ–Ω–∏–∂–∞—Ç—å—Å—è –Ω–∏–∂–µ —Ç–µ–∫—É—â–µ–π + –±–æ–Ω—É—Å –¥–≤–∏–∂–µ–Ω–∏—è
        const targetTemp = ambientTemp + heatBonus + movementBonus; // –¶–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞ (¬∞C)
        const tempDiff = targetTemp - this.temperature; // –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ü–µ–ª–µ–≤–æ–π –∏ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π (¬∞C)
        
        // –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç –¥–≤–∏–∂–µ—Ç—Å—è, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–µ –º–æ–∂–µ—Ç –ø–æ–Ω–∏–∂–∞—Ç—å—Å—è
        if (movementBonus > 0 && tempDiff < 0) {
            // –ü—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –º–æ–∂–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–≤—ã—à–∞—Ç—å—Å—è –∏–ª–∏ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–∞ –º–µ—Å—Ç–µ
            const minTempWithMovement = this.temperature + movementBonus * TEMP_CONFIG.TEMP_CHANGE_RATE; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ (¬∞C)
            this.temperature = Math.max(this.temperature, minTempWithMovement); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –Ω–µ –Ω–∏–∂–µ –º–∏–Ω–∏–º—É–º–∞
        } else {
            // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –º–µ–Ω—è–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
            this.temperature += tempDiff * TEMP_CONFIG.TEMP_CHANGE_RATE; // –ü–ª–∞–≤–Ω–æ –∏–∑–º–µ–Ω—è–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
        }
        
        // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
        const MIN_TEMP = TEMP_CONFIG.MIN_AMBIENT_TEMP || 20; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞ (¬∞C)
        const MAX_TEMP = window.GAME_CONFIG?.AGENTS?.MAX_TEMPERATURE || 37; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞ (¬∞C)
        if (this.temperature < MIN_TEMP) this.temperature = MIN_TEMP;
        if (this.temperature > MAX_TEMP) this.temperature = MAX_TEMP;
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        if (this.position) {
            this.lastPosition = { x: this.position.x, y: this.position.y };
        }
    }

    findNearestFire() {
        if (!window.world || !window.world.fires) return null;
        
        let nearestFire = null; // –ë–ª–∏–∂–∞–π—à–∏–π –∫–æ—Å—Ç–µ—Ä (–æ–±—ä–µ–∫—Ç {x, y, intensity, heatRadius} –∏–ª–∏ null)
        let minDistance = Infinity; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–æ—Å—Ç—Ä–∞ (–ø–∏–∫—Å–µ–ª–∏, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å)
        
        window.world.fires.forEach(fire => {
            const distance = Math.sqrt(
                Math.pow(fire.x - this.position.x, 2) + 
                Math.pow(fire.y - this.position.y, 2)
            ); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ—Å—Ç—Ä–∞ (–ø–∏–∫—Å–µ–ª–∏)
            if (distance < minDistance) {
                minDistance = distance; // –û–±–Ω–æ–≤–ª—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
                nearestFire = fire; // –û–±–Ω–æ–≤–ª—è–µ–º –±–ª–∏–∂–∞–π—à–∏–π –∫–æ—Å—Ç–µ—Ä
            }
        });
        
        return nearestFire; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –±–ª–∏–∂–∞–π—à–∏–π –∫–æ—Å—Ç–µ—Ä –∏–ª–∏ null
    }

    decide() {
        // –ü—Ä–æ—Å—Ç–æ–π –∫–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
        const oldState = this.state; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ä–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        
        // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≥–µ–Ω—Ç–æ–º - –ù–ï –ø—Ä–∏–Ω–∏–º–∞–µ–º —Ä–µ—à–µ–Ω–∏—è –ò–ò
        if (this.isPlayerControlled && this.targetPosition) {
            // –ò–≥—Ä–æ–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç - –æ—Å—Ç–∞–µ–º—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è –∫ —Ü–µ–ª–∏
            this.state = 'moveToPoint';
            return; // –í—ã—Ö–æ–¥–∏–º, –Ω–µ –º–µ–Ω—è—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        }
        
        // –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç —Å–ø–∏—Ç - –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º —Ä–µ—à–µ–Ω–∏–π (–±—É–¥–µ—Ç –ø—Ä–æ–±—É–∂–¥–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ update())
        if (this.state === 'sleep') {
            return;
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–Ω–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞—Å—ã–ø–∞–Ω–∏—è
        const SLEEP_CONFIG = window.GAME_CONFIG?.AGENTS?.SLEEP || {
            AUTO_SLEEP_ENERGY_THRESHOLD: 20, // –ü–æ—Ä–æ–≥ —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞—Å—ã–ø–∞–Ω–∏—è (0-100)
            AUTO_SLEEP_NIGHT: true           // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞—Å—ã–ø–∞–Ω–∏–µ –Ω–æ—á—å—é (true/false)
        };
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞—Å—ã–ø–∞–Ω–∏–µ –ø—Ä–∏ –Ω–∏–∑–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏ –∏–ª–∏ –Ω–æ—á—å—é
        const isNight = window.world && (window.world.timeOfDay === 'night' || window.world.weather === 'night'); // –§–ª–∞–≥ –Ω–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (true/false)
        if ((this.energy < SLEEP_CONFIG.AUTO_SLEEP_ENERGY_THRESHOLD || 
             (SLEEP_CONFIG.AUTO_SLEEP_NIGHT && isNight)) && 
            this.state !== 'sleep') {
            this.state = 'sleep';
            this.sleepStartTime = Date.now();
            if (!this.lastSleepTime) {
                this.lastSleepTime = Date.now();
            }
            if (window.addLogEntry) {
                window.addLogEntry(`üò¥ ${this.name} –∑–∞—Å—ã–ø–∞–µ—Ç ${isNight ? '–Ω–∞ –Ω–æ—á—å' : '–æ—Ç —É—Å—Ç–∞–ª–æ—Å—Ç–∏'}`);
            }
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Ö–∏—â–Ω–∏–∫–æ–≤ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏
        this.checkForPredators();
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –±–æ–ª—å–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏
        this.checkForSickAgents();
        
        // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –æ–±–æ—Ä–æ–Ω–∞ > –ª–µ—á–µ–Ω–∏–µ –±–æ–ª—å–Ω—ã—Ö > —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ > –≥–æ–ª–æ–¥ > –∫–æ—Ä–º–ª–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö > —ç–Ω–µ—Ä–≥–∏—è > –∏–≥—Ä–∞
        if (this.nearbyPredator && this.nearbyPredator.distance < 50) {
            // –•–∏—â–Ω–∏–∫ –±–ª–∏–∑–∫–æ - –æ–±–æ—Ä–æ–Ω—è–µ–º—Å—è
            this.state = 'defend';
        } else if (this.sickAgent && this.hasMedicalSupplies()) {
            // –ï—Å—Ç—å –±–æ–ª—å–Ω–æ–π –∞–≥–µ–Ω—Ç –∏ –µ—Å—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ - –ª–µ—á–∏–º
            this.state = 'heal';
        } else if (this.temperature < 32) {
            // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ —Ö–æ–ª–æ–¥–Ω–æ - –∏—â–µ–º —Ç–µ–ø–ª–æ
            this.state = 'findHeat';
        } else if (this.temperature < 35 && this.experience.fire_building > 0 && this.hasWoodForFire()) {
            // –•–æ–ª–æ–¥–Ω–æ –∏ –µ—Å—Ç—å –Ω–∞–≤—ã–∫ —Ä–∞–∑–∂–∏–≥–∞–Ω–∏—è –∫–æ—Å—Ç—Ä–∞ –∏ –¥—Ä–æ–≤–∞ - —Ä–∞–∑–≤–æ–¥–∏–º –∫–æ—Å—Ç–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            this.state = 'buildFire';
        } else {
            const SEARCH_FOOD_THRESHOLD = window.GAME_CONFIG?.AGENTS?.HUNGER?.SEARCH_FOOD_THRESHOLD || 70; // –ü–æ—Ä–æ–≥ –≥–æ–ª–æ–¥–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–∏—Å–∫–∞ –µ–¥—ã (0-100)
            const STORE_FOOD_THRESHOLD = window.GAME_CONFIG?.AGENTS?.HUNGER?.STORE_FOOD_THRESHOLD || 50; // –ü–æ—Ä–æ–≥ –≥–æ–ª–æ–¥–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ –∑–∞–ø–∞—Å–∞–Ω–∏—è –µ–¥—ã (0-100)
            
            if (this.hunger > SEARCH_FOOD_THRESHOLD) {
                this.state = 'findFood';
            } else if (this.hasHungryPets()) {
                // –ï—Å—Ç—å –≥–æ–ª–æ–¥–Ω—ã–µ –¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ
                this.state = 'feedAnimal';
            } else if (this.hunger < STORE_FOOD_THRESHOLD && this.foodStorage.length < 5) {
                // –ó–∞–ø–∞—Å–∞–µ–º –µ–¥—É
                this.state = 'storeFood';
            } else if (this.energy < 30) {
                this.state = 'rest';
            } else if (this.pets.length > 0 && Math.random() < 0.1) {
                // –ò–Ω–æ–≥–¥–∞ –∏–≥—Ä–∞–µ–º —Å –¥–æ–º–∞—à–Ω–∏–º–∏ –∂–∏–≤–æ—Ç–Ω—ã–º–∏
                this.state = 'playWithPet';
            } else {
                this.state = 'explore';
            }
        }
        
        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–º–µ–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏)
        if (oldState !== this.state && window.addLogEntry) {
            const stateNames = {
                'explore': '–∏—Å—Å–ª–µ–¥—É–µ—Ç',
                'findFood': '–∏—â–µ—Ç –µ–¥—É',
                'rest': '–æ—Ç–¥—ã—Ö–∞–µ—Ç',
                'findHeat': '–∏—â–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç–µ–ø–ª–∞',
                'buildFire': '—Ä–∞–∑–≤–æ–¥–∏—Ç –∫–æ—Å—Ç–µ—Ä',
                'defend': '–æ–±–æ—Ä–æ–Ω—è–µ—Ç—Å—è',
                'feedAnimal': '–∫–æ—Ä–º–∏—Ç –∂–∏–≤–æ—Ç–Ω—ã—Ö',
                'playWithPet': '–∏–≥—Ä–∞–µ—Ç —Å –ø–∏—Ç–æ–º—Ü–µ–º',
                'storeFood': '–∑–∞–ø–∞—Å–∞–µ—Ç –µ–¥—É',
                'moveToPoint': '–¥–≤–∏–∂–µ—Ç—Å—è –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ç–æ—á–∫–µ'
            };
            window.addLogEntry(`${this.name} ${stateNames[this.state] || this.state}`);
        }
        
        this.act();
    }
    
    checkForPredators() {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ö–∏—â–Ω–∏–∫–æ–≤ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏
        this.nearbyPredator = null; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ö–∏—â–Ω–∏–∫–∞
        if (!window.world || !window.world.predators) return;
        
        let minDistance = Infinity; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ö–∏—â–Ω–∏–∫–∞ (–ø–∏–∫—Å–µ–ª–∏, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å)
        window.world.predators.forEach(predator => {
            const distance = Math.sqrt(
                Math.pow(predator.x - this.position.x, 2) + 
                Math.pow(predator.y - this.position.y, 2)
            ); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ç–µ–∫—É—â–µ–≥–æ —Ö–∏—â–Ω–∏–∫–∞ (–ø–∏–∫—Å–µ–ª–∏)
            if (distance < minDistance && distance < 100) { // –ï—Å–ª–∏ —Ö–∏—â–Ω–∏–∫ –±–ª–∏–∂–µ –∏ –≤ —Ä–∞–¥–∏—É—Å–µ 100 –ø–∏–∫—Å–µ–ª–µ–π
                minDistance = distance; // –û–±–Ω–æ–≤–ª—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
                this.nearbyPredator = { predator, distance }; // –°–æ—Ö—Ä–∞–Ω—è–µ–º –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ö–∏—â–Ω–∏–∫–∞ –∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –Ω–µ–≥–æ
            }
        });
    }
    
    hasHungryPets() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≥–æ–ª–æ–¥–Ω—ã–µ –¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ
        if (!window.world) return false;
        return this.pets.some(petId => {
            const pet = window.world.animals.find(a => a.id === petId);
            return pet && pet.hunger > 60;
        });
    }
    
    hasWoodForFire() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥—Ä–æ–≤–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ –¥–ª—è –∫–æ—Å—Ç—Ä–∞
        const woodCount = this.inventory.filter(item => item.type === 'wood').length; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —Ç–∏–ø–∞ 'wood' –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
        return woodCount >= 3; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º true, –µ—Å–ª–∏ –µ—Å—Ç—å –º–∏–Ω–∏–º—É–º 3 –¥—Ä–æ–≤–∞ –¥–ª—è –∫–æ—Å—Ç—Ä–∞
    }

    act() {
        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
        switch(this.state) {
            case 'moveToPoint':
                // –î–≤–∏–∂–µ–Ω–∏–µ –∫ —Ç–æ—á–∫–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–π –∏–≥—Ä–æ–∫–æ–º - –ü–†–ò–û–†–ò–¢–ï–¢
                if (this.targetPosition) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–∞–ª–∏–¥–Ω—ã
                    if (typeof this.targetPosition.x === 'number' && typeof this.targetPosition.y === 'number' &&
                        !isNaN(this.targetPosition.x) && !isNaN(this.targetPosition.y)) {
                        this.moveTo(this.targetPosition.x, this.targetPosition.y);
                    } else {
                        console.error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–ª–∏:', this.targetPosition);
                        this.targetPosition = null;
                        this.isPlayerControlled = false;
                    }
                    return; // –í—ã—Ö–æ–¥–∏–º, –Ω–µ –≤—ã–ø–æ–ª–Ω—è—è –¥—Ä—É–≥–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
                } else {
                    // –¶–µ–ª—å –ø–æ—Ç–µ—Ä—è–Ω–∞ - –æ—á–∏—â–∞–µ–º —Ñ–ª–∞–≥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                    this.isPlayerControlled = false;
                    this.state = 'explore';
                }
                // –ï—Å–ª–∏ —Ü–µ–ª—å –ø–æ—Ç–µ—Ä—è–Ω–∞, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ–±—ã—á–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é
                break;
            case 'explore':
                this.moveToRandomPoint();
                this.scanForResources();
                break;
            case 'findFood':
                let foodLocation = this.memory.find(item => item.type === 'berry' || item.type === 'berries'); // –ù–∞–π–¥–µ–Ω–Ω–∞—è –≤ –ø–∞–º—è—Ç–∏ –ª–æ–∫–∞—Ü–∏—è –µ–¥—ã (–æ–±—ä–µ–∫—Ç {type, x, y} –∏–ª–∏ undefined)
                if (foodLocation) {
                    this.moveTo(foodLocation.x, foodLocation.y); // –î–≤–∏–≥–∞–µ–º—Å—è –∫ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –µ–¥–µ
                } else {
                    this.moveToRandomPoint(); // –ï—Å–ª–∏ –µ–¥—ã –≤ –ø–∞–º—è—Ç–∏ –Ω–µ—Ç - –¥–≤–∏–≥–∞–µ–º—Å—è —Å–ª—É—á–∞–π–Ω–æ
                    this.scanForResources(); // –°–∫–∞–Ω–∏—Ä—É–µ–º —Ä–µ—Å—É—Ä—Å—ã –≤–æ–∫—Ä—É–≥
                }
                break;
            case 'findHeat':
                // –ò—â–µ–º –±–ª–∏–∂–∞–π—à–∏–π –∫–æ—Å—Ç–µ—Ä
                const nearestFire = this.findNearestFire(); // –ë–ª–∏–∂–∞–π—à–∏–π –∫–æ—Å—Ç–µ—Ä (–æ–±—ä–µ–∫—Ç {x, y, intensity, heatRadius} –∏–ª–∏ null)
                if (nearestFire) {
                    this.moveTo(nearestFire.x, nearestFire.y); // –î–≤–∏–≥–∞–µ–º—Å—è –∫ –∫–æ—Å—Ç—Ä—É
                } else {
                    // –ï—Å–ª–∏ –Ω–µ—Ç –∫–æ—Å—Ç—Ä–æ–≤, –∏—â–µ–º –¥—Ä–æ–≤–∞ –¥–ª—è —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è
                    if (this.canBuildFire) { // –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç –º–æ–∂–µ—Ç —Ä–∞–∑–≤–æ–¥–∏—Ç—å –∫–æ—Å—Ç–µ—Ä
                        this.moveToRandomPoint(); // –î–≤–∏–≥–∞–µ–º—Å—è —Å–ª—É—á–∞–π–Ω–æ
                        this.scanForResources(); // –°–∫–∞–Ω–∏—Ä—É–µ–º —Ä–µ—Å—É—Ä—Å—ã (–∏—â–µ–º –¥—Ä–æ–≤–∞)
                    } else {
                        // –ù–µ –º–æ–∂–µ–º —Ä–∞–∑–≤–µ—Å—Ç–∏ –∫–æ—Å—Ç–µ—Ä - –ø—Ä–æ—Å—Ç–æ –¥–≤–∏–≥–∞–µ–º—Å—è
                        this.moveToRandomPoint(); // –î–≤–∏–≥–∞–µ–º—Å—è —Å–ª—É—á–∞–π–Ω–æ
                    }
                }
                break;
            case 'buildFire':
                // –†–∞–∑–≤–æ–¥–∏–º –∫–æ—Å—Ç–µ—Ä
                this.buildFire();
                break;
            case 'defend':
                // –û–±–æ—Ä–æ–Ω–∞ –æ—Ç —Ö–∏—â–Ω–∏–∫–∞
                this.defendAgainstPredator();
                break;
            case 'feedAnimal':
                // –ö–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö
                this.feedPets();
                break;
            case 'playWithPet':
                // –ò–≥—Ä–∞ —Å –¥–æ–º–∞—à–Ω–∏–º –∂–∏–≤–æ—Ç–Ω—ã–º
                this.playWithPets();
                break;
            case 'storeFood':
                // –ó–∞–ø–∞—Å–∞–Ω–∏–µ –µ–¥—ã
                this.storeFood();
                break;
            case 'rest':
                // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ –º–µ—Å—Ç–µ
                this.energy += 10;
                if (this.energy > this.maxEnergy) {
                    this.energy = this.maxEnergy;
                }
                break;
            case 'cook':
                // –ì–æ—Ç–æ–≤–∫–∞ –µ–¥—ã
                this.cook();
                break;
            case 'hunt':
                // –û—Ö–æ—Ç–∞
                this.hunt();
                break;
            case 'build':
                // –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ
                this.build();
                break;
            case 'fish':
                // –†—ã–±–∞–ª–∫–∞
                this.fish();
                break;
            case 'farm':
                // –§–µ—Ä–º–µ—Ä—Å—Ç–≤–æ
                this.farm();
                break;
            case 'heal':
                // –õ–µ—á–µ–Ω–∏–µ –±–æ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
                this.heal();
                break;
        }
    }
    
    cook() {
        // –ì–æ—Ç–æ–≤–∫–∞ –µ–¥—ã
        if (!window.world) return;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∫–æ—Å—Ç–µ—Ä –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ (–¥–ª—è –≥–æ—Ç–æ–≤–∫–∏ –Ω—É–∂–µ–Ω –æ–≥–æ–Ω—å)
        const nearestFire = this.findNearestFire(); // –ë–ª–∏–∂–∞–π—à–∏–π –∫–æ—Å—Ç–µ—Ä (–æ–±—ä–µ–∫—Ç {x, y, intensity, heatRadius} –∏–ª–∏ null)
        const hasFireNearby = nearestFire && 
            Math.sqrt(Math.pow(nearestFire.x - this.position.x, 2) + Math.pow(nearestFire.y - this.position.y, 2)) < 30; // –§–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è –∫–æ—Å—Ç—Ä–∞ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ (true/false, —Ä–∞–¥–∏—É—Å 30 –ø–∏–∫—Å–µ–ª–µ–π)
        
        if (!hasFireNearby) {
            // –ù–µ—Ç –∫–æ—Å—Ç—Ä–∞ - –∏–¥–µ–º –∫ –±–ª–∏–∂–∞–π—à–µ–º—É –∏–ª–∏ —Ä–∞–∑–≤–æ–¥–∏–º —Å–≤–æ–π
            if (nearestFire) {
                this.moveTo(nearestFire.x, nearestFire.y);
            } else if (this.experience.fire_building >= 5 && this.hasWoodForFire()) {
                // –ú–æ–∂–µ–º —Ä–∞–∑–≤–µ—Å—Ç–∏ –∫–æ—Å—Ç–µ—Ä
                this.state = 'buildFire';
                return;
            } else {
                // –ù–µ—Ç –∫–æ—Å—Ç—Ä–∞ –∏ –Ω–µ –º–æ–∂–µ–º —Ä–∞–∑–≤–µ—Å—Ç–∏ - –∏—â–µ–º
                if (window.addLogEntry && Math.random() < 0.2) {
                    window.addLogEntry(`üç≥ ${this.name} –Ω—É–∂–µ–Ω –∫–æ—Å—Ç–µ—Ä –¥–ª—è –≥–æ—Ç–æ–≤–∫–∏`);
                }
                this.state = 'findHeat';
                return;
            }
            return;
        }
        
        // –ù—É–∂–Ω—ã –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã (–º—è—Å–æ, —Ä—ã–±–∞, —è–≥–æ–¥—ã, –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å –∏ —Ç.–¥.)
        const ingredients = this.inventory.find(item => 
            ['meat', 'fish', 'bird', 'berries', 'potato', 'mushrooms'].includes(item.type)
        ); // –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –¥–ª—è –≥–æ—Ç–æ–≤–∫–∏ (–æ–±—ä–µ–∫—Ç {type, amount} –∏–ª–∏ undefined)
        
        if (!ingredients) {
            // –ù–µ—Ç –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ - –∏—â–µ–º –∏—Ö
            if (window.addLogEntry && Math.random() < 0.2) {
                window.addLogEntry(`üç≥ ${this.name} –Ω—É–∂–Ω—ã –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –¥–ª—è –≥–æ—Ç–æ–≤–∫–∏`);
            }
            this.state = 'findFood';
            return;
        }
        
        // –ì–æ—Ç–æ–≤–∏–º –µ–¥—É (–Ω—É–∂–Ω–æ –≤—Ä–µ–º—è)
        if (!this.cookingProgress) {
            this.cookingProgress = 0; // –ü—Ä–æ–≥—Ä–µ—Å—Å –≥–æ—Ç–æ–≤–∫–∏ (—á–∏—Å–ª–æ –∫–∞–¥—Ä–æ–≤, 0 = –Ω–∞—á–∞–ª–æ –≥–æ—Ç–æ–≤–∫–∏)
        }
        
        this.cookingProgress += 1; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≥–æ—Ç–æ–≤–∫–∏
        
        // –ì–æ—Ç–æ–≤–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ 10-20 –∫–∞–¥—Ä–æ–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–≤—ã–∫–∞)
        const cookingTime = 20 - Math.floor(this.experience.cooking / 10); // –í—Ä–µ–º—è –≥–æ—Ç–æ–≤–∫–∏ –≤ –∫–∞–¥—Ä–∞—Ö (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–ø—ã—Ç–∞ –≥–æ—Ç–æ–≤–∫–∏)
        if (this.cookingProgress < cookingTime) {
            // –ï—â–µ –≥–æ—Ç–æ–≤–∏–º
            return;
        }
        
        // –ì–æ—Ç–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
        const cookedFood = {
            type: 'cooked_food', // –¢–∏–ø –≥–æ—Ç–æ–≤–æ–π –µ–¥—ã
            amount: 1            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Ç–æ–≤–æ–π –µ–¥—ã
        };
        
        // –£–±–∏—Ä–∞–µ–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç
        ingredients.amount--; // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞
        if (ingredients.amount <= 0) {
            const index = this.inventory.indexOf(ingredients); // –ò–Ω–¥–µ–∫—Å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
            if (index > -1) this.inventory.splice(index, 1); // –£–¥–∞–ª—è–µ–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –≥–æ—Ç–æ–≤—É—é –µ–¥—É
        this.inventory.push(cookedFood);
        this.gainExperience('cooking', 2);
        this.cookingProgress = 0;
        
        if (window.addLogEntry) {
            window.addLogEntry(`üç≥ ${this.name} –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª(–∞) –µ–¥—É —É –∫–æ—Å—Ç—Ä–∞`);
        }
        
        this.state = 'explore';
    }
    
    hunt() {
        // –û—Ö–æ—Ç–∞
        if (!window.world || !window.world.animals) return;
        
        // –ò—â–µ–º –¥–∏–∫–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö (–Ω–µ –ø—Ä–∏—Ä—É—á–µ–Ω–Ω—ã—Ö)
        let target = null; // –¶–µ–ª–µ–≤–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ –¥–ª—è –æ—Ö–æ—Ç—ã (–æ–±—ä–µ–∫—Ç –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –∏–ª–∏ null)
        let minDistance = Infinity; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–ª–∏ (–ø–∏–∫—Å–µ–ª–∏, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—å)
        
        window.world.animals.forEach(animal => {
            if (animal.tamed || animal.owner) return; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö
            
            const dx = animal.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–æ–º –∏ –∂–∏–≤–æ—Ç–Ω—ã–º (–ø–∏–∫—Å–µ–ª–∏)
            const dy = animal.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–æ–º –∏ –∂–∏–≤–æ—Ç–Ω—ã–º (–ø–∏–∫—Å–µ–ª–∏)
            const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
            
            if (distance < 50 && distance < minDistance) { // –ï—Å–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–µ –≤ —Ä–∞–¥–∏—É—Å–µ 50 –ø–∏–∫—Å–µ–ª–µ–π –∏ –±–ª–∏–∂–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ
                target = animal; // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–ª—å
                minDistance = distance; // –û–±–Ω–æ–≤–ª—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
            }
        });
        
        if (target) {
            if (minDistance > 10) {
                // –ò–¥–µ–º –∫ —Ü–µ–ª–∏
                this.moveTo(target.x, target.y);
            } else {
                // –û—Ö–æ—Ç–∏–º—Å—è
                const success = Math.random() < 0.3 + this.experience.hunting / 100; // –®–∞–Ω—Å —É—Å–ø–µ—à–Ω–æ–π –æ—Ö–æ—Ç—ã (0-1, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–ø—ã—Ç–∞)
                if (success) {
                    // –£—Å–ø–µ—à–Ω–∞—è –æ—Ö–æ—Ç–∞
                    this.inventory.push({ type: 'meat', amount: 1 }); // –î–æ–±–∞–≤–ª—è–µ–º –º—è—Å–æ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                    this.gainExperience('hunting', 3); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç –æ—Ö–æ—Ç—ã
                    
                    // –£–¥–∞–ª—è–µ–º –∂–∏–≤–æ—Ç–Ω–æ–µ
                    const index = window.world.animals.indexOf(target); // –ò–Ω–¥–µ–∫—Å –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –≤ –º–∞—Å—Å–∏–≤–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö –º–∏—Ä–∞
                    if (index > -1) window.world.animals.splice(index, 1); // –£–¥–∞–ª—è–µ–º –∂–∏–≤–æ—Ç–Ω–æ–µ –∏–∑ –º–∏—Ä–∞
                    
                    if (window.addLogEntry) {
                        window.addLogEntry(`üéØ ${this.name} —É—Å–ø–µ—à–Ω–æ –æ—Ö–æ—Ç–∏—Ç—Å—è!`);
                    }
                } else {
                    if (window.addLogEntry && Math.random() < 0.2) {
                        window.addLogEntry(`üéØ ${this.name} –ø—Ä–æ–º–∞—Ö–Ω—É–ª—Å—è –Ω–∞ –æ—Ö–æ—Ç–µ`);
                    }
                }
                this.state = 'explore';
            }
        } else {
            // –ù–µ—Ç —Ü–µ–ª–µ–π - –∏—â–µ–º
            this.moveToRandomPoint();
        }
    }
    
    build() {
        // –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ
        if (!window.world) return;
        
        // –ù—É–∂–Ω—ã –º–∞—Ç–µ—Ä–∏–∞–ª—ã (–¥–µ—Ä–µ–≤–æ, –∫–∞–º–µ–Ω—å)
        const hasWood = this.inventory.some(item => item.type === 'wood'); // –§–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è –¥–µ—Ä–µ–≤–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (true/false)
        const hasStone = this.inventory.some(item => item.type === 'stone'); // –§–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è –∫–∞–º–Ω—è –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (true/false)
        
        if (!hasWood && !hasStone) {
            // –ù–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ - –∏—â–µ–º
            this.state = 'findFood';
            return;
        }
        
        // –°—Ç—Ä–æ–∏–º (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        if (hasWood) {
            const wood = this.inventory.find(item => item.type === 'wood'); // –ù–∞–π–¥–µ–Ω–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (–æ–±—ä–µ–∫—Ç {type, amount})
            wood.amount--; // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤–∞
            if (wood.amount <= 0) {
                const index = this.inventory.indexOf(wood); // –ò–Ω–¥–µ–∫—Å –¥–µ—Ä–µ–≤–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
                if (index > -1) this.inventory.splice(index, 1); // –£–¥–∞–ª—è–µ–º –¥–µ—Ä–µ–≤–æ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            }
        }
        
        this.gainExperience('building', 2);
        
        if (window.addLogEntry && Math.random() < 0.3) {
            window.addLogEntry(`üèóÔ∏è ${this.name} —Å—Ç—Ä–æ–∏—Ç`);
        }
        
        this.state = 'explore';
    }
    
    fish() {
        // –†—ã–±–∞–ª–∫–∞ - –Ω—É–∂–Ω–∞ —É–¥–æ—á–∫–∞ –∏ –≤–æ–¥–æ–µ–º
        if (!window.world) return;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–¥–æ—á–∫–∞
        const hasFishingRod = this.inventory.some(item => item.type === 'fishing_rod'); // –§–ª–∞–≥ –Ω–∞–ª–∏—á–∏—è —É–¥–æ—á–∫–∏ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (true/false)
        if (!hasFishingRod) {
            // –ù–µ—Ç —É–¥–æ—á–∫–∏ - –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º —Ä—ã–±–∞–ª–∫—É
            if (window.addLogEntry && Math.random() < 0.2) {
                window.addLogEntry(`üé£ ${this.name} –Ω—É–∂–Ω–∞ —É–¥–æ—á–∫–∞ –¥–ª—è —Ä—ã–±–∞–ª–∫–∏`);
            }
            this.state = 'explore';
            return;
        }
        
        // –ò—â–µ–º –≤–æ–¥–æ–µ–º (–ø—Ä—É–¥) - –≤ —Ü–µ–Ω—Ç—Ä–µ –∫–∞—Ä—Ç—ã –æ–±—ã—á–Ω–æ –µ—Å—Ç—å –ø—Ä—É–¥
        const pondCenterX = window.world.canvas ? window.world.canvas.width / 2 : 400; // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X —Ü–µ–Ω—Ç—Ä–∞ –ø—Ä—É–¥–∞ (–ø–∏–∫—Å–µ–ª–∏)
        const pondCenterY = window.world.canvas ? window.world.canvas.height / 2 : 300; // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y —Ü–µ–Ω—Ç—Ä–∞ –ø—Ä—É–¥–∞ (–ø–∏–∫—Å–µ–ª–∏)
        const pondRadius = 100; // –†–∞–¥–∏—É—Å –ø—Ä—É–¥–∞ (–ø–∏–∫—Å–µ–ª–∏)
        
        const dx = pondCenterX - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ —Ü–µ–Ω—Ç—Ä–∞ –ø—Ä—É–¥–∞ (–ø–∏–∫—Å–µ–ª–∏)
        const dy = pondCenterY - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ —Ü–µ–Ω—Ç—Ä–∞ –ø—Ä—É–¥–∞ (–ø–∏–∫—Å–µ–ª–∏)
        const distanceToPond = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–Ω—Ç—Ä–∞ –ø—Ä—É–¥–∞ (–ø–∏–∫—Å–µ–ª–∏)
        
        if (distanceToPond > pondRadius + 20) {
            // –î–∞–ª–µ–∫–æ –æ—Ç –ø—Ä—É–¥–∞ - –∏–¥–µ–º –∫ –Ω–µ–º—É
            this.moveTo(pondCenterX, pondCenterY);
            return;
        }
        
        // –£ –ø—Ä—É–¥–∞ - –ª–æ–≤–∏–º —Ä—ã–±—É
        if (!this.fishingProgress) {
            this.fishingProgress = 0; // –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä—ã–±–∞–ª–∫–∏ (—á–∏—Å–ª–æ –∫–∞–¥—Ä–æ–≤, 0 = –Ω–∞—á–∞–ª–æ —Ä—ã–±–∞–ª–∫–∏)
        }
        
        this.fishingProgress += 1; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä—ã–±–∞–ª–∫–∏
        
        // –†—ã–±–∞–ª–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –≤—Ä–µ–º—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–≤—ã–∫–∞)
        const fishingTime = 15 - Math.floor(this.experience.fishing / 10); // –í—Ä–µ–º—è —Ä—ã–±–∞–ª–∫–∏ –≤ –∫–∞–¥—Ä–∞—Ö (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–ø—ã—Ç–∞ —Ä—ã–±–∞–ª–∫–∏)
        if (this.fishingProgress < fishingTime) {
            // –ï—â–µ –ª–æ–≤–∏–º
            return;
        }
        
        // –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–π–º–∞—Ç—å —Ä—ã–±—É (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–≤—ã–∫–∞)
        const successChance = 0.2 + (this.experience.fishing / 100); // –®–∞–Ω—Å —É—Å–ø–µ—à–Ω–æ–π —Ä—ã–±–∞–ª–∫–∏ (0-1, –±–∞–∑–æ–≤—ã–π 20% + –æ–ø—ã—Ç)
        const success = Math.random() < successChance; // –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ø—ã—Ç–∫–∏ (true/false)
        
        if (success) {
            // –£—Å–ø–µ—à–Ω–∞—è —Ä—ã–±–∞–ª–∫–∞
            const fishCount = Math.random() < 0.3 ? 2 : 1; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–π–º–∞–Ω–Ω–æ–π —Ä—ã–±—ã (1 –∏–ª–∏ 2, 30% —à–∞–Ω—Å –Ω–∞ 2)
            this.inventory.push({ type: 'fish', amount: fishCount }); // –î–æ–±–∞–≤–ª—è–µ–º —Ä—ã–±—É –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            this.gainExperience('fishing', 3); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç —Ä—ã–±–∞–ª–∫–∏
            
            if (window.addLogEntry) {
                window.addLogEntry(`üé£ ${this.name} –ø–æ–π–º–∞–ª(–∞) ${fishCount} —Ä—ã–±—É(—ã)!`);
            }
        } else {
            // –ù–µ—É–¥–∞—á–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞
            if (window.addLogEntry && Math.random() < 0.3) {
                window.addLogEntry(`üé£ ${this.name} –Ω–µ –ø–æ–π–º–∞–ª(–∞) —Ä—ã–±—É`);
            }
            this.gainExperience('fishing', 1); // –û–ø—ã—Ç –¥–∞–∂–µ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ
        }
        
        this.fishingProgress = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä—ã–±–∞–ª–∫–∏
        this.state = 'explore';
    }
    
    farm() {
        // –§–µ—Ä–º–µ—Ä—Å—Ç–≤–æ
        if (!window.world || !window.world.animals) return;
        
        // –ò—â–µ–º –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö
        let farmAnimal = null; // –î–æ–º–∞—à–Ω–µ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ –¥–ª—è —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–∞ (–æ–±—ä–µ–∫—Ç –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –∏–ª–∏ null)
        for (let petId of this.pets) {
            const pet = window.world.animals.find(a => a.id === petId); // –ù–∞–π–¥–µ–Ω–Ω–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ –ø–æ ID (–æ–±—ä–µ–∫—Ç –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –∏–ª–∏ undefined)
            if (pet && (pet.type === 'cow' || pet.type === 'goat' || pet.type === 'sheep' || pet.type === 'chicken')) {
                farmAnimal = pet; // –ù–∞—Ö–æ–¥–∏–º –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ –¥–ª—è —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–∞
                break;
            }
        }
        
        if (!farmAnimal) {
            if (window.addLogEntry) {
                window.addLogEntry(`üåæ ${this.name} –Ω—É–∂–Ω—ã –¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ –¥–ª—è —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–∞`);
            }
            this.state = 'explore';
            return;
        }
        
        const dx = farmAnimal.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        const dy = farmAnimal.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        
        if (distance > 15) {
            // –ò–¥–µ–º –∫ –∂–∏–≤–æ—Ç–Ω–æ–º—É
            this.moveTo(farmAnimal.x, farmAnimal.y);
        } else {
            // –£—Ö–∞–∂–∏–≤–∞–µ–º –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º
            farmAnimal.hunger = Math.max(0, farmAnimal.hunger - 20);
            this.gainExperience('farming', 1);
            
            // –ò–Ω–æ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ–º –ø—Ä–æ–¥—É–∫—Ç
            if (Math.random() < 0.2) {
                if (farmAnimal.type === 'chicken') {
                    this.inventory.push({ type: 'bird', amount: 1 });
                } else if (farmAnimal.type === 'cow' || farmAnimal.type === 'goat') {
                    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–ª–æ–∫–æ
                }
            }
            
            if (window.addLogEntry && Math.random() < 0.2) {
                window.addLogEntry(`üåæ ${this.name} —É—Ö–∞–∂–∏–≤–∞–µ—Ç –∑–∞ ${window.world.getAnimalName(farmAnimal.type)}`);
            }
            
            this.state = 'explore';
        }
    }
    
    defendAgainstPredator() {
        // –û–±–æ—Ä–æ–Ω–∞ –æ—Ç —Ö–∏—â–Ω–∏–∫–∞
        if (!this.nearbyPredator) return;
        
        const predator = this.nearbyPredator.predator; // –û–±—ä–µ–∫—Ç —Ö–∏—â–Ω–∏–∫–∞ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã x, y –∏ –¥—Ä—É–≥–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞)
        const distance = this.nearbyPredator.distance; // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ö–∏—â–Ω–∏–∫–∞ (–ø–∏–∫—Å–µ–ª–∏)
        
        // –ï—Å–ª–∏ —Ö–∏—â–Ω–∏–∫ –æ—á–µ–Ω—å –±–ª–∏–∑–∫–æ - –æ—Ç—Å—Ç—É–ø–∞–µ–º
        if (distance < 30) {
            const dx = this.position.x - predator.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç —Ö–∏—â–Ω–∏–∫–∞, –ø–∏–∫—Å–µ–ª–∏)
            const dy = this.position.y - predator.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç —Ö–∏—â–Ω–∏–∫–∞, –ø–∏–∫—Å–µ–ª–∏)
            const dist = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ö–∏—â–Ω–∏–∫–∞ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–∏–∫—Å–µ–ª–∏)
            if (dist > 0) {
                this.position.x += (dx / dist) * this.speed * 1.5; // –û—Ç—Å—Ç—É–ø–∞–µ–º –±—ã—Å—Ç—Ä–µ–µ (—Å–∫–æ—Ä–æ—Å—Ç—å * 1.5)
                this.position.y += (dy / dist) * this.speed * 1.5;
            }
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–ø—ã—Ç –æ–±–æ—Ä–æ–Ω—ã
            this.defenseSkill += 0.5; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–∞–≤—ã–∫ –æ–±–æ—Ä–æ–Ω—ã
            this.gainExperience('hunting', 0.3); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç –æ—Ö–æ—Ç—ã/–æ–±–æ—Ä–æ–Ω—ã
            
            if (window.addLogEntry && Math.random() < 0.1) {
                window.addLogEntry(`‚öîÔ∏è ${this.name} –æ–±–æ—Ä–æ–Ω—è–µ—Ç—Å—è –æ—Ç —Ö–∏—â–Ω–∏–∫–∞!`);
            }
        } else {
            // –î–µ—Ä–∂–∏–º –¥–∏—Å—Ç–∞–Ω—Ü–∏—é
            const dx = this.position.x - predator.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç —Ö–∏—â–Ω–∏–∫–∞, –ø–∏–∫—Å–µ–ª–∏)
            const dy = this.position.y - predator.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y (–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç —Ö–∏—â–Ω–∏–∫–∞, –ø–∏–∫—Å–µ–ª–∏)
            const dist = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ö–∏—â–Ω–∏–∫–∞ –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–∏–∫—Å–µ–ª–∏)
            if (dist > 0 && dist < 40) { // –ï—Å–ª–∏ —Ö–∏—â–Ω–∏–∫ –≤ —Ä–∞–¥–∏—É—Å–µ 40 –ø–∏–∫—Å–µ–ª–µ–π
                this.position.x += (dx / dist) * this.speed; // –û—Ç—Å—Ç—É–ø–∞–µ–º —Å –æ–±—ã—á–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é
                this.position.y += (dy / dist) * this.speed;
            }
        }
    }
    
    feedPets() {
        // –ö–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö
        if (!window.world || this.pets.length === 0) return;
        
        // –ò—â–µ–º –≥–æ–ª–æ–¥–Ω–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ
        let hungryPet = null; // –ì–æ–ª–æ–¥–Ω–æ–µ –¥–æ–º–∞—à–Ω–µ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ (–æ–±—ä–µ–∫—Ç –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –∏–ª–∏ null)
        for (let petId of this.pets) {
            const pet = window.world.animals.find(a => a.id === petId); // –ù–∞–π–¥–µ–Ω–Ω–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ –ø–æ ID (–æ–±—ä–µ–∫—Ç –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –∏–ª–∏ undefined)
            if (pet && pet.hunger > 60) { // –ï—Å–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–µ –≥–æ–ª–æ–¥–Ω–æ (–≥–æ–ª–æ–¥ > 60)
                hungryPet = pet; // –ù–∞—Ö–æ–¥–∏–º –≥–æ–ª–æ–¥–Ω–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ
                break;
            }
        }
        
        if (!hungryPet) return;
        
        // –î–≤–∏–≥–∞–µ–º—Å—è –∫ –∂–∏–≤–æ—Ç–Ω–æ–º—É
        const dx = hungryPet.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        const dy = hungryPet.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        
        if (distance > 20) {
            this.moveTo(hungryPet.x, hungryPet.y);
        } else {
            // –ö–æ—Ä–º–∏–º –∂–∏–≤–æ—Ç–Ω–æ–µ
            const food = this.animalFoodStorage.find(f => f.amount > 0); // –ù–∞–π–¥–µ–Ω–Ω–∞—è –µ–¥–∞ –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö (–æ–±—ä–µ–∫—Ç {type, amount} –∏–ª–∏ undefined)
            if (food) {
                hungryPet.hunger -= 30; // –£–º–µ–Ω—å—à–∞–µ–º –≥–æ–ª–æ–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –Ω–∞ 30
                if (hungryPet.hunger < 0) hungryPet.hunger = 0; // –ù–µ –¥–∞–µ–º –≥–æ–ª–æ–¥—É —É–π—Ç–∏ –≤ –º–∏–Ω—É—Å
                food.amount--; // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥—ã
                if (food.amount <= 0) {
                    const index = this.animalFoodStorage.indexOf(food); // –ò–Ω–¥–µ–∫—Å –µ–¥—ã –≤ –º–∞—Å—Å–∏–≤–µ –∑–∞–ø–∞—Å–æ–≤ –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö
                    if (index > -1) this.animalFoodStorage.splice(index, 1); // –£–¥–∞–ª—è–µ–º –ø—É—Å—Ç—É—é –µ–¥—É
                }
                
                this.gainExperience('farming', 0.5);
                
                if (window.addLogEntry && Math.random() < 0.3) {
                    window.addLogEntry(`ü•ï ${this.name} –∫–æ—Ä–º–∏—Ç ${window.world.getAnimalName(hungryPet.type)}`);
                }
            } else {
                // –ù–µ—Ç –µ–¥—ã –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö - –∏—â–µ–º
                this.state = 'findFood';
            }
        }
    }
    
    playWithPets() {
        // –ò–≥—Ä–∞ —Å –¥–æ–º–∞—à–Ω–∏–º –∂–∏–≤–æ—Ç–Ω—ã–º
        if (!window.world || this.pets.length === 0) return;
        
        const petId = this.pets[Math.floor(Math.random() * this.pets.length)]; // –°–ª—É—á–∞–π–Ω—ã–π ID –ø–∏—Ç–æ–º—Ü–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
        const pet = window.world.animals.find(a => a.id === petId); // –ù–∞–π–¥–µ–Ω–Ω–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ –ø–æ ID (–æ–±—ä–µ–∫—Ç –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –∏–ª–∏ undefined)
        
        if (!pet) return;
        
        // –î–≤–∏–≥–∞–µ–º—Å—è –∫ –∂–∏–≤–æ—Ç–Ω–æ–º—É
        const dx = pet.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        const dy = pet.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ (–ø–∏–∫—Å–µ–ª–∏)
        
        if (distance > 25) {
            this.moveTo(pet.x, pet.y);
        } else {
            // –ò–≥—Ä–∞–µ–º —Å –∂–∏–≤–æ—Ç–Ω—ã–º
            this.mood = 'happy';
            this.energy += 5; // –ò–≥—Ä–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —ç–Ω–µ—Ä–≥–∏—é
            if (this.energy > this.maxEnergy) this.energy = this.maxEnergy;
            
            if (window.addLogEntry && Math.random() < 0.2) {
                window.addLogEntry(`üéÆ ${this.name} –∏–≥—Ä–∞–µ—Ç —Å ${window.world.getAnimalName(pet.type)}`);
            }
        }
    }
    
    storeFood() {
        // –ó–∞–ø–∞—Å–∞–Ω–∏–µ –µ–¥—ã
        // –ò—â–µ–º –µ–¥—É –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
        const foodItems = this.inventory.filter(item => 
            ['berries', 'cooked_food', 'meat', 'bird', 'fish'].includes(item.type)
        ); // –ú–∞—Å—Å–∏–≤ –µ–¥—ã –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è (–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ {type, amount})
        
        if (foodItems.length > 0) {
            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –µ–¥—É –≤ –∑–∞–ø–∞—Å—ã (–¥–ª—è —Å–µ–±—è –∏ –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö)
            const food = foodItems[0]; // –ü–µ—Ä–≤–∞—è –Ω–∞–π–¥–µ–Ω–Ω–∞—è –µ–¥–∞ (–æ–±—ä–µ–∫—Ç {type, amount})
            const index = this.inventory.indexOf(food); // –ò–Ω–¥–µ–∫—Å –µ–¥—ã –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
            if (index > -1) {
                this.inventory.splice(index, 1); // –£–¥–∞–ª—è–µ–º –µ–¥—É –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                
                // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ–∂–¥—É –∑–∞–ø–∞—Å–∞–º–∏ –¥–ª—è —Å–µ–±—è –∏ –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö
                if (this.pets.length > 0 && Math.random() < 0.5) {
                    // –ß–∞—Å—Ç—å –µ–¥—ã –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö (50% —à–∞–Ω—Å, –µ—Å–ª–∏ –µ—Å—Ç—å –ø–∏—Ç–æ–º—Ü—ã)
                    this.animalFoodStorage.push({
                        type: food.type,        // –¢–∏–ø –µ–¥—ã
                        amount: food.amount || 1 // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
                    });
                } else {
                    // –ï–¥–∞ –¥–ª—è —Å–µ–±—è
                    this.foodStorage.push({
                        type: food.type,        // –¢–∏–ø –µ–¥—ã
                        amount: food.amount || 1 // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
                    });
                }
                
                if (window.addLogEntry && Math.random() < 0.2) {
                    window.addLogEntry(`üì¶ ${this.name} –∑–∞–ø–∞—Å–∞–µ—Ç –µ–¥—É`);
                }
            }
        } else {
            // –ù–µ—Ç –µ–¥—ã - –∏—â–µ–º
            this.state = 'findFood';
        }
    }

    buildFire() {
        // –†–∞–∑–≤–µ–¥–µ–Ω–∏–µ –∫–æ—Å—Ç—Ä–∞ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–≤—ã–∫ fire_building)
        if (this.experience.fire_building <= 0) {
            if (window.addLogEntry) {
                window.addLogEntry(`‚ùå ${this.name} –Ω–µ —É–º–µ–µ—Ç —Ä–∞–∑–∂–∏–≥–∞—Ç—å –∫–æ—Å—Ç–µ—Ä`);
            }
            this.state = 'explore';
            return;
        }
        
        if (!this.hasWoodForFire()) {
            if (window.addLogEntry) {
                window.addLogEntry(`‚ùå ${this.name} –Ω–µ—Ç –¥—Ä–æ–≤ –¥–ª—è –∫–æ—Å—Ç—Ä–∞`);
            }
            this.state = 'explore';
            return;
        }
        
        if (!window.world) return;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ –∫–æ—Å—Ç—Ä–∞ —Ä—è–¥–æ–º
        const existingFire = window.world.fires.find(fire => {
            const distance = Math.sqrt(
                Math.pow(fire.x - this.position.x, 2) + 
                Math.pow(fire.y - this.position.y, 2)
            ); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ—Å—Ç—Ä–∞ (–ø–∏–∫—Å–µ–ª–∏)
            return distance < 30; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º true, –µ—Å–ª–∏ –∫–æ—Å—Ç–µ—Ä –±–ª–∏–∂–µ 30 –ø–∏–∫—Å–µ–ª–µ–π (–Ω–µ —Ä–∞–∑–≤–æ–¥–∏–º –∫–æ—Å—Ç–µ—Ä —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ –∫ –¥—Ä—É–≥–æ–º—É)
        }); // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ—Å—Ç–µ—Ä –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ (–æ–±—ä–µ–∫—Ç {x, y, id, intensity, heatRadius} –∏–ª–∏ undefined)
        
        if (existingFire) {
            // –£–∂–µ –µ—Å—Ç—å –∫–æ—Å—Ç–µ—Ä —Ä—è–¥–æ–º - –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä–æ–≤
            const woodItem = this.inventory.find(item => item.type === 'wood'); // –ù–∞–π–¥–µ–Ω–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (–æ–±—ä–µ–∫—Ç {type, amount} –∏–ª–∏ undefined)
            if (woodItem && woodItem.amount > 0 && window.world.addWoodToFire) {
                window.world.addWoodToFire(existingFire.id, 1); // –î–æ–±–∞–≤–ª—è–µ–º 1 –¥—Ä–æ–≤–æ –≤ –∫–æ—Å—Ç–µ—Ä
                woodItem.amount--; // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤–∞
                if (woodItem.amount <= 0) {
                    const index = this.inventory.indexOf(woodItem); // –ò–Ω–¥–µ–∫—Å –¥–µ—Ä–µ–≤–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
                    if (index > -1) this.inventory.splice(index, 1); // –£–¥–∞–ª—è–µ–º –¥–µ—Ä–µ–≤–æ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
                }
                this.gainExperience('bring_wood', 0.5); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç –ø—Ä–∏–Ω–µ—Å–µ–Ω–∏—è –¥—Ä–æ–≤
                if (window.addLogEntry) {
                    window.addLogEntry(`üî• ${this.name} –ø–æ–¥–±—Ä–æ—Å–∏–ª(–∞) –¥—Ä–æ–≤ –≤ –∫–æ—Å—Ç–µ—Ä`);
                }
            }
            this.state = 'rest';
            return;
        }
        
        // –£–±–∏—Ä–∞–µ–º –¥—Ä–æ–≤–∞ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        const woodNeeded = 2; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—Ä–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è —Ä–∞–∑–≤–µ–¥–µ–Ω–∏—è –∫–æ—Å—Ç—Ä–∞
        let woodRemoved = 0; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –¥—Ä–æ–≤ (—Å—á–µ—Ç—á–∏–∫)
        for (let i = this.inventory.length - 1; i >= 0 && woodRemoved < woodNeeded; i--) {
            if (this.inventory[i].type === 'wood') {
                const item = this.inventory[i]; // –¢–µ–∫—É—â–∏–π –ø—Ä–µ–¥–º–µ—Ç –¥–µ—Ä–µ–≤–∞ (–æ–±—ä–µ–∫—Ç {type, amount})
                if (item.amount <= woodNeeded - woodRemoved) {
                    woodRemoved += item.amount; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –¥—Ä–æ–≤
                    this.inventory.splice(i, 1); // –£–¥–∞–ª—è–µ–º –≤–µ—Å—å –ø—Ä–µ–¥–º–µ—Ç
                } else {
                    item.amount -= (woodNeeded - woodRemoved); // –£–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤–∞ –Ω–∞ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
                    woodRemoved = woodNeeded; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–∞ –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
                }
            }
        }
        
        // –°–æ–∑–¥–∞–µ–º –∫–æ—Å—Ç–µ—Ä
        if (window.world.addFire) {
            window.world.addFire(this.position.x, this.position.y, this.ownerId);
            this.gainExperience('fire_building', 2); // –û–ø—ã—Ç —Ä–∞–∑–∂–∏–≥–∞–Ω–∏—è –∫–æ—Å—Ç—Ä–∞
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            if (window.networkManager && window.networkManager.isConnected) {
                window.networkManager.buildFire(this.position.x, this.position.y);
            }
            
            if (window.addLogEntry) {
                window.addLogEntry(`üî• ${this.name} —Ä–∞–∑–≤–µ–ª –∫–æ—Å—Ç–µ—Ä –≤ (${Math.floor(this.position.x)}, ${Math.floor(this.position.y)})`);
            }
        }
        
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ç–¥—ã—Ö–∞ —É –∫–æ—Å—Ç—Ä–∞
        this.state = 'rest';
    }

    moveTo(x, y) {
        // –î–≤–∏–∂–µ–Ω–∏–µ –∫ —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ç–æ—á–∫–µ
        const dx = x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ —Ü–µ–ª–∏ (–ø–∏–∫—Å–µ–ª–∏)
        const dy = y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ —Ü–µ–ª–∏ (–ø–∏–∫—Å–µ–ª–∏)
        const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–ª–∏ (–ø–∏–∫—Å–µ–ª–∏)
        
        // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (—á—Ç–æ–±—ã –Ω–µ –¥—Ä–æ–∂–∞–ª –Ω–∞ –º–µ—Å—Ç–µ)
        const minDistance = 2; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (–ø–∏–∫—Å–µ–ª–∏)
        
        if (distance > minDistance) {
            // –î–≤–∏–≥–∞–µ–º—Å—è –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ü–µ–ª–∏
            const moveDistance = Math.min(distance, this.speed || 2); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –∑–∞ –∫–∞–¥—Ä (–Ω–µ –±–æ–ª—å—à–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–∞)
            if (moveDistance > 0 && distance > 0) {
                this.position.x += (dx / distance) * moveDistance; // –î–≤–∏–≥–∞–µ–º—Å—è –ø–æ –æ—Å–∏ X (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ * —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ)
                this.position.y += (dy / distance) * moveDistance; // –î–≤–∏–≥–∞–µ–º—Å—è –ø–æ –æ—Å–∏ Y (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ * —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ)
            }
        } else {
            // –î–æ—Å—Ç–∏–≥–ª–∏ —Ü–µ–ª–∏
            this.position.x = x; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ—á–Ω—É—é –ø–æ–∑–∏—Ü–∏—é —Ü–µ–ª–∏
            this.position.y = y; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ—á–Ω—É—é –ø–æ–∑–∏—Ü–∏—é —Ü–µ–ª–∏
            
            // –û—á–∏—â–∞–µ–º —Ü–µ–ª—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ò
            this.targetPosition = null; // –û—á–∏—â–∞–µ–º —Ü–µ–ª–µ–≤—É—é –ø–æ–∑–∏—Ü–∏—é
            this.isPlayerControlled = false; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ò
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —á—Ç–æ–±—ã –ò–ò –º–æ–≥ –ø—Ä–∏–Ω—è—Ç—å –Ω–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ
            this.state = 'explore';
            
            if (window.addLogEntry) {
                window.addLogEntry(`‚úÖ ${this.name} –¥–æ—Å—Ç–∏–≥ —Ü–µ–ª–∏. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ –ò–ò.`);
            }
        }
        
        // –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π –º–∏—Ä - –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
        // –ü–æ–∑–∏—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π
    }
    
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–µ–ª–∏ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    setTarget(x, y) {
        this.targetPosition = { x, y }; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–ª–µ–≤—É—é –ø–æ–∑–∏—Ü–∏—é (–æ–±—ä–µ–∫—Ç {x, y})
        this.isPlayerControlled = true; // –í–∫–ª—é—á–∞–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–º
        // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –∫ —Ü–µ–ª–∏
        this.state = 'moveToPoint';
        
        if (window.addLogEntry) {
            window.addLogEntry(`üéØ ${this.name} –ø–æ–ª—É—á–∏–ª –∫–æ–º–∞–Ω–¥—É –¥–≤–∏–≥–∞—Ç—å—Å—è –∫ (${Math.floor(x)}, ${Math.floor(y)}). –ò–ò –æ—Ç–∫–ª—é—á–µ–Ω.`);
        }
    }
    
    // –û—á–∏—Å—Ç–∫–∞ —Ü–µ–ª–∏
    clearTarget() {
        this.targetPosition = null; // –û—á–∏—â–∞–µ–º —Ü–µ–ª–µ–≤—É—é –ø–æ–∑–∏—Ü–∏—é
        this.isPlayerControlled = false; // –û—Ç–∫–ª—é—á–∞–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–º
    }

    moveToRandomPoint() {
        // –î–≤–∏–∂–µ–Ω–∏–µ –∫ —Å–ª—É—á–∞–π–Ω–æ–π —Ç–æ—á–∫–µ
        if (window.world && window.world.canvas) {
            const targetX = Math.random() * window.world.canvas.width; // –°–ª—É—á–∞–π–Ω–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —à–∏—Ä–∏–Ω—ã –∫–∞—Ä—Ç—ã (–ø–∏–∫—Å–µ–ª–∏)
            const targetY = Math.random() * window.world.canvas.height; // –°–ª—É—á–∞–π–Ω–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≤—ã—Å–æ—Ç—ã –∫–∞—Ä—Ç—ã (–ø–∏–∫—Å–µ–ª–∏)
            this.moveTo(targetX, targetY);
        }
    }

    scanForResources() {
        // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤–æ–∫—Ä—É–≥ –∞–≥–µ–Ω—Ç–∞
        if (!window.world) return;
        
        const scanRadius = 50; // –†–∞–¥–∏—É—Å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (–ø–∏–∫—Å–µ–ª–∏)
        const resources = window.world.resources; // –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –º–∏—Ä–µ
        
        resources.forEach(resource => {
            const dx = resource.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ —Ä–µ—Å—É—Ä—Å–∞ (–ø–∏–∫—Å–µ–ª–∏)
            const dy = resource.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ —Ä–µ—Å—É—Ä—Å–∞ (–ø–∏–∫—Å–µ–ª–∏)
            const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ä–µ—Å—É—Ä—Å–∞ (–ø–∏–∫—Å–µ–ª–∏)
            
            if (distance <= scanRadius) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ —ç—Ç–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –≤ –ø–∞–º—è—Ç–∏
                const existingMemory = this.memory.find(m => 
                    Math.abs(m.x - resource.x) < 10 && // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–∏–∑–æ—Å—Ç–∏ –ø–æ X (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10 –ø–∏–∫—Å–µ–ª–µ–π)
                    Math.abs(m.y - resource.y) < 10 && // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–∏–∑–æ—Å—Ç–∏ –ø–æ Y (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10 –ø–∏–∫—Å–µ–ª–µ–π)
                    m.type === resource.type // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ç–∏–ø–∞ —Ä–µ—Å—É—Ä—Å–∞
                ); // –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∑–∞–ø–∏—Å—å –≤ –ø–∞–º—è—Ç–∏ –æ —Ä–µ—Å—É—Ä—Å–µ (–æ–±—ä–µ–∫—Ç {type, x, y} –∏–ª–∏ undefined)
                
                if (!existingMemory) {
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –ø–∞–º—è—Ç—å
                    this.memory.push({
                        type: resource.type, // –¢–∏–ø —Ä–µ—Å—É—Ä—Å–∞
                        x: resource.x,       // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X —Ä–µ—Å—É—Ä—Å–∞
                        y: resource.y        // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y —Ä–µ—Å—É—Ä—Å–∞
                    });
                    
                    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞
                    if (window.addLogEntry && resource.type === 'berries') {
                        window.addLogEntry(`${this.name} –∑–∞–º–µ—Ç–∏–ª —è–≥–æ–¥—ã –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏`);
                    }
                }
            }
        });
    }

    gainExperience(skill, amount = 1) {
        // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –æ–ø—ã—Ç–∞ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –Ω–∞–≤—ã–∫–µ
        if (this.experience.hasOwnProperty(skill)) { // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –Ω–∞–≤—ã–∫ –≤ –æ–±—ä–µ–∫—Ç–µ –æ–ø—ã—Ç–∞
            this.experience[skill] += amount; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–ø—ã—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç
            if (this.experience[skill] > 100) {
                this.experience[skill] = 100; // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç –∑–Ω–∞—á–µ–Ω–∏–µ–º 100
            }
        }
    }
    
    // –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –µ–¥—ã —Å —É—á–µ—Ç–æ–º –µ—ë —Å–≤–æ–π—Å—Ç–≤
    consumeFood(foodType) {
        const FOOD_PROPERTIES = window.FOOD_PROPERTIES || {}; // –û–±—ä–µ–∫—Ç —Å–æ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –µ–¥—ã
        const props = FOOD_PROPERTIES[foodType]; // –°–≤–æ–π—Å—Ç–≤–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ç–∏–ø–∞ –µ–¥—ã (–æ–±—ä–µ–∫—Ç {hunger, energy, health, ...} –∏–ª–∏ undefined)
        
        if (!props) {
            // –ï—Å–ª–∏ —Å–≤–æ–π—Å—Ç–≤ –Ω–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            this.hunger = Math.max(0, this.hunger - 20); // –£–º–µ–Ω—å—à–∞–µ–º –≥–æ–ª–æ–¥ –Ω–∞ 20 (–Ω–µ –Ω–∏–∂–µ 0)
            this.energy = Math.min(100, this.energy + 10); // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —ç–Ω–µ—Ä–≥–∏—é –Ω–∞ 10 (–Ω–µ –≤—ã—à–µ 100)
            return;
        }
        
        // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–ø–ø–µ—Ç–∏—Ç–∞ (—á–µ–º –≤—ã—à–µ –∞–ø–ø–µ—Ç–∏—Ç, —Ç–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –µ–¥–∞)
        const appetiteModifier = 1 + (this.appetite - 50) / 100; // –ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –µ–¥—ã (0.5-1.5, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞–ø–ø–µ—Ç–∏—Ç–∞)
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–≤–æ–π—Å—Ç–≤–∞ –µ–¥—ã
        if (props.hunger) {
            this.hunger = Math.max(0, this.hunger + props.hunger * appetiteModifier);
        }
        if (props.energy) {
            this.energy = Math.min(100, this.energy + props.energy * appetiteModifier);
        }
        if (props.health) {
            this.health = Math.min(100, this.health + props.health);
        }
        if (props.stamina) {
            this.stamina = Math.min(100, this.stamina + props.stamina);
        }
        if (props.immunity) {
            this.immunity = Math.min(100, this.immunity + props.immunity);
        }
        if (props.thirst) {
            this.thirst = Math.max(0, this.thirst + props.thirst);
        }
        if (props.sweetDesire) {
            this.sweetDesire = Math.max(0, this.sweetDesire + props.sweetDesire);
        }
        if (props.appetite) {
            this.appetite = Math.min(100, this.appetite + props.appetite);
        }
    }
    
    // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –µ–¥—ã
    getFoodName(foodType) {
        const foodNames = {
            'honey': '–ú—ë–¥',
            'milk': '–ú–æ–ª–æ–∫–æ',
            'water': '–í–æ–¥–∞',
            'bread': '–•–ª–µ–±',
            'kebab': '–®–∞—à–ª—ã–∫',
            'potato': '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å',
            'salad': '–°–∞–ª–∞—Ç',
            'mushrooms': '–ì—Ä–∏–±—ã',
            'tea': '–ß–∞–π',
            'banana': '–ë–∞–Ω–∞–Ω',
            'orange': '–ê–ø–µ–ª—å—Å–∏–Ω',
            'apple': '–Ø–±–ª–æ–∫–æ',
            'lemon': '–õ–∏–º–æ–Ω',
            'rosehip': '–®–∏–ø–æ–≤–Ω–∏–∫',
            'cabbage': '–ö–∞–ø—É—Å—Ç–∞',
            'spices': '–°–ø–µ—Ü–∏–∏',
            'mint': '–ú—è—Ç–∞',
            'st_johns_wort': '–ó–≤–µ—Ä–æ–±–æ–π',
            'berries': '–Ø–≥–æ–¥—ã',
            'meat': '–ú—è—Å–æ',
            'bird': '–ü—Ç–∏—Ü–∞',
            'fish': '–†—ã–±–∞',
            'cooked_food': '–ì–æ—Ç–æ–≤–∞—è –µ–¥–∞'
        };
        return foodNames[foodType] || foodType;
    }

    interactWithWorld(world) {
        // –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –º–∏—Ä–æ–º - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ–¥ –Ω–æ–≥–∞–º–∏
        const resource = world.getResourceAt(this.position.x, this.position.y); // –†–µ—Å—É—Ä—Å –Ω–∞ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏ –∞–≥–µ–Ω—Ç–∞ (–æ–±—ä–µ–∫—Ç {type, x, y, amount, id} –∏–ª–∏ null)
        
        if (resource) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–µ—Å—É—Ä—Å –µ–¥–æ–π
            const FOOD_PROPERTIES = window.FOOD_PROPERTIES || {}; // –û–±—ä–µ–∫—Ç —Å–æ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –µ–¥—ã
            const foodProps = FOOD_PROPERTIES[resource.type]; // –°–≤–æ–π—Å—Ç–≤–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ç–∏–ø–∞ —Ä–µ—Å—É—Ä—Å–∞ (–æ–±—ä–µ–∫—Ç {hunger, energy, ...} –∏–ª–∏ undefined)
            
            if (foodProps || resource.type === 'berries' || resource.type === 'berry') {
                // –≠—Ç–æ –µ–¥–∞ - –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∑–∞–ø–∞—Å—ã –∏–ª–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (–ù–ï –ø–æ—Ç—Ä–µ–±–ª—è–µ–º —Å—Ä–∞–∑—É)
                const foodType = resource.type === 'berry' ? 'berries' : resource.type; // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ç–∏–ø –µ–¥—ã ('berry' -> 'berries')
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –∏–ª–∏ –∑–∞–ø–∞—Å—ã
                const foodItem = {
                    type: foodType,              // –¢–∏–ø –µ–¥—ã
                    amount: resource.amount || 1 // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
                };
                
                // –ï—Å–ª–∏ —ç—Ç–æ –ø–æ–ª–µ–∑–Ω–∞—è –µ–¥–∞ –∏–ª–∏ —Å–ø–µ—Ü–∏–∏ - –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                if (foodProps && (foodProps.category === 'HEALTHY' || foodProps.category === 'SPICES')) {
                    this.inventory.push(foodItem); // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                } else {
                    // –û—Å—Ç–∞–ª—å–Ω–∞—è –µ–¥–∞ - –≤ –∑–∞–ø–∞—Å—ã
                    this.foodStorage.push(foodItem); // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∑–∞–ø–∞—Å—ã –µ–¥—ã
                }
                
                // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å –∏–∑ –º–∏—Ä–∞
                const index = world.resources.indexOf(resource); // –ò–Ω–¥–µ–∫—Å —Ä–µ—Å—É—Ä—Å–∞ –≤ –º–∞—Å—Å–∏–≤–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏—Ä–∞
                if (index > -1) {
                    if (window.networkManager && window.networkManager.isConnected && resource.id) {
                        window.networkManager.removeResource(resource.id); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ–± —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–µ—Å—É—Ä—Å–∞
                    }
                    world.resources.splice(index, 1); // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å –∏–∑ –º–∞—Å—Å–∏–≤–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏—Ä–∞
                }
                
                // –£–¥–∞–ª—è–µ–º –∏–∑ –ø–∞–º—è—Ç–∏
                const memoryIndex = this.memory.findIndex(m => 
                    Math.abs(m.x - resource.x) < 10 && // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–∏–∑–æ—Å—Ç–∏ –ø–æ X (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10 –ø–∏–∫—Å–µ–ª–µ–π)
                    Math.abs(m.y - resource.y) < 10    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–∏–∑–æ—Å—Ç–∏ –ø–æ Y (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 10 –ø–∏–∫—Å–µ–ª–µ–π)
                ); // –ò–Ω–¥–µ–∫—Å –∑–∞–ø–∏—Å–∏ –≤ –ø–∞–º—è—Ç–∏ –æ —Ä–µ—Å—É—Ä—Å–µ (-1, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ)
                if (memoryIndex > -1) {
                    this.memory.splice(memoryIndex, 1); // –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å –∏–∑ –ø–∞–º—è—Ç–∏
                }
                
                if (window.addLogEntry) {
                    window.addLogEntry(`${this.name} –Ω–∞—à–µ–ª –∏ —Å—ä–µ–ª ${this.getFoodName(foodType)}`);
                }
            } else if (resource.type === 'wood') {
                // –°–æ–±–∏—Ä–∞–µ–º –¥—Ä–æ–≤–∞
                this.inventory.push({
                    type: 'wood',                // –¢–∏–ø —Ä–µ—Å—É—Ä—Å–∞
                    amount: resource.amount || 1 // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—Ä–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
                });
                this.gainExperience('axe', 0.5); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–ø–æ—Ä–æ–º –ø—Ä–∏ —Å–±–æ—Ä–µ –¥—Ä–æ–≤
                
                // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å –∏–∑ –º–∏—Ä–∞
                const index = world.resources.indexOf(resource); // –ò–Ω–¥–µ–∫—Å —Ä–µ—Å—É—Ä—Å–∞ –≤ –º–∞—Å—Å–∏–≤–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏—Ä–∞
                if (index > -1) {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                    if (window.networkManager && window.networkManager.isConnected && resource.id) {
                        window.networkManager.removeResource(resource.id); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ–± —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–µ—Å—É—Ä—Å–∞
                    }
                    world.resources.splice(index, 1); // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å –∏–∑ –º–∞—Å—Å–∏–≤–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏—Ä–∞
                }
                
                // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
                if (window.addLogEntry) {
                    window.addLogEntry(`${this.name} —Å–æ–±—Ä–∞–ª –¥—Ä–æ–≤–∞ (–≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ: ${this.inventory.filter(i => i.type === 'wood').length})`);
                }
            } else {
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
                const resourceType = resource.type; // –¢–∏–ø —Ä–µ—Å—É—Ä—Å–∞ (—Å—Ç—Ä–æ–∫–∞: 'saw', 'axe', 'money', –∏ —Ç.–¥.)
                
                // –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
                if (['saw', 'axe', 'hammer', 'pickaxe', 'shovel', 'fishing_rod'].includes(resourceType)) {
                    this.inventory.push({ type: resourceType, amount: 1 }); // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                    const skillMap = {
                        'saw': 'saw',              // –ü–∏–ª–∞ -> –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –ø–∏–ª–æ–π
                        'axe': 'axe',              // –¢–æ–ø–æ—Ä -> –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–ø–æ—Ä–æ–º
                        'hammer': 'building',      // –ú–æ–ª–æ—Ç–æ–∫ -> –æ–ø—ã—Ç —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞
                        'pickaxe': 'building',      // –ö–∏—Ä–∫–∞ -> –æ–ø—ã—Ç —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞
                        'shovel': 'farming',        // –õ–æ–ø–∞—Ç–∞ -> –æ–ø—ã—Ç —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–∞
                        'fishing_rod': 'fishing'   // –£–¥–æ—á–∫–∞ -> –æ–ø—ã—Ç —Ä—ã–±–∞–ª–∫–∏
                    }; // –ö–∞—Ä—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –Ω–∞–≤—ã–∫–æ–≤ –æ–ø—ã—Ç–∞
                    if (skillMap[resourceType]) {
                        this.gainExperience(skillMap[resourceType], 1); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –Ω–∞–≤—ã–∫–∞
                    }
                    if (window.addLogEntry) {
                        window.addLogEntry(`${this.name} –ø–æ–¥–æ–±—Ä–∞–ª ${this.getResourceName(resourceType)}`);
                    }
                }
                // –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã
                else if (resourceType === 'first_aid_kit') {
                    this.inventory.push({ type: 'first_aid_kit', amount: 1 }); // –î–æ–±–∞–≤–ª—è–µ–º –∞–ø—Ç–µ—á–∫—É –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                    if (window.addLogEntry) {
                        window.addLogEntry(`${this.name} –ø–æ–¥–æ–±—Ä–∞–ª –∞–ø—Ç–µ—á–∫—É`);
                    }
                }
                // –û–¥–µ–∂–¥–∞
                else if (['summer_clothes_man', 'summer_clothes_woman', 'winter_clothes_man', 'winter_clothes_woman'].includes(resourceType)) {
                    this.inventory.push({ type: resourceType, amount: 1 }); // –î–æ–±–∞–≤–ª—è–µ–º –æ–¥–µ–∂–¥—É –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                    if (window.addLogEntry) {
                        window.addLogEntry(`${this.name} –ø–æ–¥–æ–±—Ä–∞–ª –æ–¥–µ–∂–¥—É`);
                    }
                }
                // –ï–¥–∞
                else if (['cooked_food', 'meat', 'bird', 'fish'].includes(resourceType)) {
                    this.inventory.push({ type: resourceType, amount: resource.amount || 1 }); // –î–æ–±–∞–≤–ª—è–µ–º –µ–¥—É –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                    this.hunger -= resourceType === 'cooked_food' ? 30 : 25; // –£–º–µ–Ω—å—à–∞–µ–º –≥–æ–ª–æ–¥ (–≥–æ—Ç–æ–≤–∞—è –µ–¥–∞ —É—Ç–æ–ª—è–µ—Ç –±–æ–ª—å—à–µ)
                    if (this.hunger < 0) this.hunger = 0; // –ù–µ –¥–∞–µ–º –≥–æ–ª–æ–¥—É —É–π—Ç–∏ –≤ –º–∏–Ω—É—Å
                    if (resourceType === 'cooked_food') {
                        this.gainExperience('cooking', 0.3); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç –≥–æ—Ç–æ–≤–∫–∏ –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏ –≥–æ—Ç–æ–≤–æ–π –µ–¥—ã
                    }
                    if (window.addLogEntry) {
                        window.addLogEntry(`${this.name} –ø–æ–¥–æ–±—Ä–∞–ª ${this.getResourceName(resourceType)}`);
                    }
                }
                // –î–µ–Ω—å–≥–∏
                else if (resourceType === 'money') {
                    this.inventory.push({ type: 'money', amount: resource.amount || 10 }); // –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–Ω—å–≥–∏ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 –º–æ–Ω–µ—Ç)
                    if (window.addLogEntry) {
                        window.addLogEntry(`${this.name} –Ω–∞—à–µ–ª –¥–µ–Ω—å–≥–∏`);
                    }
                }
                
                // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å –∏–∑ –º–∏—Ä–∞
                const index = world.resources.indexOf(resource); // –ò–Ω–¥–µ–∫—Å —Ä–µ—Å—É—Ä—Å–∞ –≤ –º–∞—Å—Å–∏–≤–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏—Ä–∞
                if (index > -1) {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                    if (window.networkManager && window.networkManager.isConnected && resource.id) {
                        window.networkManager.removeResource(resource.id); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ–± —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–µ—Å—É—Ä—Å–∞
                    }
                    world.resources.splice(index, 1); // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å –∏–∑ –º–∞—Å—Å–∏–≤–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏—Ä–∞
                }
            }
        }
    }
    
    getResourceName(type) {
        const names = {
            'saw': '–ø–∏–ª—É',
            'axe': '—Ç–æ–ø–æ—Ä',
            'hammer': '–º–æ–ª–æ—Ç–æ–∫',
            'pickaxe': '–∫–∏—Ä–∫—É',
            'shovel': '–ª–æ–ø–∞—Ç—É',
            'fishing_rod': '—É–¥–æ—á–∫—É',
            'first_aid_kit': '–∞–ø—Ç–µ—á–∫—É',
            'cooked_food': '–≥–æ—Ç–æ–≤—É—é –µ–¥—É',
            'meat': '–º—è—Å–æ',
            'bird': '–ø—Ç–∏—Ü—É',
            'fish': '—Ä—ã–±—É',
            'money': '–¥–µ–Ω—å–≥–∏'
        };
        return names[type] || type;
    }

    // –ú–µ—Ç–æ–¥—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ —Å—Ç–∞—Ä—ã–º –∫–æ–¥–æ–º
    get x() {
        return this.position.x;
    }

    set x(value) {
        this.position.x = value;
    }

    get y() {
        return this.position.y;
    }

    set y(value) {
        this.position.y = value;
    }

    gatherResources() {
        // –°–æ–±–∏—Ä–∞—Ç—å –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏
        if (!window.world) return;
        
        const gatherRadius = 30; // –†–∞–¥–∏—É—Å —Å–±–æ—Ä–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ (–ø–∏–∫—Å–µ–ª–∏)
        const resources = window.world.resources; // –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –º–∏—Ä–µ
        let gathered = false; // –§–ª–∞–≥ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–±–æ—Ä–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ (true/false)
        
        resources.forEach(resource => {
            const dx = resource.x - this.position.x; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ X –¥–æ —Ä–µ—Å—É—Ä—Å–∞ (–ø–∏–∫—Å–µ–ª–∏)
            const dy = resource.y - this.position.y; // –†–∞–∑–Ω–∏—Ü–∞ –ø–æ –æ—Å–∏ Y –¥–æ —Ä–µ—Å—É—Ä—Å–∞ (–ø–∏–∫—Å–µ–ª–∏)
            const distance = Math.sqrt(dx * dx + dy * dy); // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ä–µ—Å—É—Ä—Å–∞ (–ø–∏–∫—Å–µ–ª–∏)
            
            if (distance <= gatherRadius) {
                gathered = true; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–±–æ—Ä–∞
                
                // –°–æ–±–∏—Ä–∞–µ–º —Ä–µ—Å—É—Ä—Å
                if (resource.type === 'fish') {
                    this.gainExperience('gather_fish', 1); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç —Å–±–æ—Ä–∞ —Ä—ã–±—ã
                } else if (resource.type === 'wood') {
                    this.gainExperience('gather_wood', 1); // –ü–æ–ª—É—á–∞–µ–º –æ–ø—ã—Ç —Å–±–æ—Ä–∞ –¥—Ä–æ–≤
                }
                this.gainExperience('gather_all', 0.5); // –ü–æ–ª—É—á–∞–µ–º –æ–±—â–∏–π –æ–ø—ã—Ç —Å–±–æ—Ä–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                const existingItem = this.inventory.find(item => item.type === resource.type); // –ù–∞–π–¥–µ–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç —Ç–æ–≥–æ –∂–µ —Ç–∏–ø–∞ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ (–æ–±—ä–µ–∫—Ç {type, amount} –∏–ª–∏ undefined)
                if (existingItem) {
                    existingItem.amount += resource.amount || 1; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞
                } else {
                    this.inventory.push({
                        type: resource.type,        // –¢–∏–ø —Ä–µ—Å—É—Ä—Å–∞
                        amount: resource.amount || 1 // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Å—É—Ä—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
                    }); // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                }
                
                // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å
                const index = resources.indexOf(resource); // –ò–Ω–¥–µ–∫—Å —Ä–µ—Å—É—Ä—Å–∞ –≤ –º–∞—Å—Å–∏–≤–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏—Ä–∞
                if (index > -1) {
                    if (window.networkManager && window.networkManager.isConnected && resource.id) {
                        window.networkManager.removeResource(resource.id); // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –æ–± —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–µ—Å—É—Ä—Å–∞
                    }
                    resources.splice(index, 1); // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å –∏–∑ –º–∞—Å—Å–∏–≤–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–∏—Ä–∞
                }
            }
        });
        
        if (gathered && window.addLogEntry && Math.random() < 0.3) {
            window.addLogEntry(`üåø ${this.name} —Å–æ–±—Ä–∞–ª(–∞) —Ä–µ—Å—É—Ä—Å—ã`);
        }
        
        this.state = 'explore';
    }
    
    getStateName() {
        if (this.health > 70) return '–ó–¥–æ—Ä–æ–≤';
        if (this.health > 40) return '–†–∞–Ω–µ–Ω';
        return '–ë–æ–ª–µ–Ω';
    }

    getPsycheName() {
        if (this.panic) return '–ü–∞–Ω–∏–∫–∞';
        if (this.fear > 70) return '–°–∏–ª—å–Ω—ã–π —Å—Ç—Ä–∞—Ö';
        if (this.fear > 40) return '–°—Ç—Ä–∞—Ö';
        if (this.mood === 'neutral') return '–°–ø–æ–∫–æ–µ–Ω';
        if (this.mood === 'anxious') return '–ù–∞–ø—Ä—è–∂–µ–Ω';
        if (this.mood === 'happy') return '–°—á–∞—Å—Ç–ª–∏–≤';
        return '–ì—Ä—É—Å—Ç–µ–Ω';
    }
}

// –î–æ—á–µ—Ä–Ω–∏–µ –∫–ª–∞—Å—Å—ã

class YoungMan extends Agent {
    constructor(name, age, type, ownerId = null) {
        super(name, age, 'male', type, ownerId); // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ Agent
        this.energy = 100; // –≠–Ω–µ—Ä–≥–∏—è –º–æ–ª–æ–¥–æ–≥–æ –º—É–∂—á–∏–Ω—ã (100 - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è)
        this.maxEnergy = 100; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –º–æ–ª–æ–¥–æ–≥–æ –º—É–∂—á–∏–Ω—ã (100)
        this.speed = 3; // –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –º–æ–ª–æ–¥–æ–≥–æ –º—É–∂—á–∏–Ω—ã (3 –ø–∏–∫—Å–µ–ª—è –∑–∞ –∫–∞–¥—Ä, –±—ã—Å—Ç—Ä–µ–µ —á–µ–º —É –¥—Ä—É–≥–∏—Ö)
        this.maxHealth = 100; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –º–æ–ª–æ–¥–æ–≥–æ –º—É–∂—á–∏–Ω—ã (100)
        // –ú–æ–ª–æ–¥—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞
        this.initializeExperience(0.1); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–ø—ã—Ç —Å –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º 0.1 (10% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞)
    }
    
    initializeExperience(multiplier) {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø—ã—Ç–∞ —Å –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º
        Object.keys(this.experience).forEach(key => {
            this.experience[key] = Math.floor(Math.random() * 10 * multiplier); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –æ–ø—ã—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–≤—ã–∫–∞ (0-10 * –º–Ω–æ–∂–∏—Ç–µ–ª—å)
        });
    }
}

class OldMan extends Agent {
    constructor(name, age, type, ownerId = null) {
        super(name, age, 'male', type, ownerId); // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ Agent
        this.energy = 60; // –≠–Ω–µ—Ä–≥–∏—è —Å—Ç–∞—Ä–∏–∫–∞ (60 - –Ω–∏–∑–∫–∞—è –±–∞–∑–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è)
        this.maxEnergy = 60; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å—Ç–∞—Ä–∏–∫–∞ (60)
        this.speed = 1; // –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è —Å—Ç–∞—Ä–∏–∫–∞ (1 –ø–∏–∫—Å–µ–ª—å –∑–∞ –∫–∞–¥—Ä, –º–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º —É –¥—Ä—É–≥–∏—Ö)
        this.maxHealth = 80; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ —Å—Ç–∞—Ä–∏–∫–∞ (80)
        this.canBuildFire = true; // –°—Ç–∞—Ä–∏–∫ —É–º–µ–µ—Ç —Ä–∞–∑–≤–æ–¥–∏—Ç—å –∫–æ—Å—Ç–µ—Ä (true)
        // –°—Ç–∞—Ä–∏–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞
        this.initializeExperience(1.5); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–ø—ã—Ç —Å –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º 1.5 (150% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞)
    }
    
    initializeExperience(multiplier) {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø—ã—Ç–∞ —Å –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º
        // –°—Ç–∞—Ä–∏–∫–∏ –∏–º–µ—é—Ç –≤—ã—Å–æ–∫–∏–π –æ–ø—ã—Ç –≤–æ –≤—Å–µ—Ö –Ω–∞–≤—ã–∫–∞—Ö
        Object.keys(this.experience).forEach(key => {
            // –ë–∞–∑–æ–≤—ã–π –æ–ø—ã—Ç 30-80, —É–º–Ω–æ–∂–µ–Ω–Ω—ã–π –Ω–∞ –º–Ω–æ–∂–∏—Ç–µ–ª—å
            this.experience[key] = Math.floor(30 + Math.random() * 50 * multiplier); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –æ–ø—ã—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–≤—ã–∫–∞ (30-80 * –º–Ω–æ–∂–∏—Ç–µ–ª—å)
            // –°—Ç–∞—Ä–∏–∫–∏ –∏–º–µ—é—Ç –æ—Å–æ–±–æ –≤—ã—Å–æ–∫–∏–π –æ–ø—ã—Ç –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –Ω–∞–≤—ã–∫–∞—Ö
            if (key === 'building' || key === 'farming' || key === 'cooking') {
                this.experience[key] = Math.floor(60 + Math.random() * 40 * multiplier); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π –æ–ø—ã—Ç –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞, —Ñ–µ—Ä–º–µ—Ä—Å—Ç–≤–∞ –∏ –≥–æ—Ç–æ–≤–∫–∏ (60-100 * –º–Ω–æ–∂–∏—Ç–µ–ª—å)
            }
        });
    }

    update() {
        // –°—Ç–∞—Ä–∏–∫ –±—ã—Å—Ç—Ä–µ–µ —Ç–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ
        super.update(); // –í—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ update() —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞
        if (this.hunger > 60) {
            this.health -= 0.8; // –ü–æ—Ç–µ—Ä—è –∑–¥–æ—Ä–æ–≤—å—è —Å—Ç–∞—Ä–∏–∫–∞ –ø—Ä–∏ –≥–æ–ª–æ–¥–µ (0.8 –∑–∞ –∫–∞–¥—Ä, –±–æ–ª—å—à–µ —á–µ–º —É –¥—Ä—É–≥–∏—Ö)
        }
        // –°—Ç–∞—Ä–∏–∫ –±—ã—Å—Ç—Ä–µ–µ –∑–∞–º–µ—Ä–∑–∞–µ—Ç
        if (this.temperature < 35) {
            this.temperature -= 0.1; // –ü–æ—Ç–µ—Ä—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Å—Ç–∞—Ä–∏–∫–∞ –ø—Ä–∏ —Ö–æ–ª–æ–¥–µ (0.1¬∞C –∑–∞ –∫–∞–¥—Ä, –±—ã—Å—Ç—Ä–µ–µ —á–µ–º —É –¥—Ä—É–≥–∏—Ö)
        }
    }
}

class YoungWoman extends Agent {
    constructor(name, age, type, ownerId = null) {
        super(name, age, 'female', type, ownerId); // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ Agent
        this.energy = 90; // –≠–Ω–µ—Ä–≥–∏—è –º–æ–ª–æ–¥–æ–π –∂–µ–Ω—â–∏–Ω—ã (90)
        this.maxEnergy = 90; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –º–æ–ª–æ–¥–æ–π –∂–µ–Ω—â–∏–Ω—ã (90)
        this.speed = 2.5; // –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –º–æ–ª–æ–¥–æ–π –∂–µ–Ω—â–∏–Ω—ã (2.5 –ø–∏–∫—Å–µ–ª—è –∑–∞ –∫–∞–¥—Ä, –±—ã—Å—Ç—Ä–µ–µ –¥–≤–∏–≥–∞–µ—Ç—Å—è)
        this.maxHealth = 100; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –º–æ–ª–æ–¥–æ–π –∂–µ–Ω—â–∏–Ω—ã (100)
        // –ú–æ–ª–æ–¥—ã–µ –Ω–∞—á–∏–Ω–∞—é—Ç —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞
        this.initializeExperience(0.1); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–ø—ã—Ç —Å –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º 0.1 (10% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞)
    }
    
    initializeExperience(multiplier) {
        Object.keys(this.experience).forEach(key => {
            this.experience[key] = Math.floor(Math.random() * 10 * multiplier); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –æ–ø—ã—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–≤—ã–∫–∞ (0-10 * –º–Ω–æ–∂–∏—Ç–µ–ª—å)
        });
    }
}

class OldWoman extends Agent {
    constructor(name, age, type, ownerId = null) {
        super(name, age, 'female', type, ownerId); // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ Agent
        this.energy = 55; // –≠–Ω–µ—Ä–≥–∏—è —Å—Ç–∞—Ä—É—Ö–∏ (55 - –Ω–∏–∑–∫–∞—è –±–∞–∑–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è)
        this.maxEnergy = 55; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å—Ç–∞—Ä—É—Ö–∏ (55)
        this.speed = 1; // –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è —Å—Ç–∞—Ä—É—Ö–∏ (1 –ø–∏–∫—Å–µ–ª—å –∑–∞ –∫–∞–¥—Ä, –º–µ–¥–ª–µ–Ω–Ω–µ–µ –¥–≤–∏–≥–∞–µ—Ç—Å—è)
        this.maxHealth = 75; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ —Å—Ç–∞—Ä—É—Ö–∏ (75)
        this.canBuildFire = true; // –°—Ç–∞—Ä—É—Ö–∞ —É–º–µ–µ—Ç —Ä–∞–∑–≤–æ–¥–∏—Ç—å –∫–æ—Å—Ç–µ—Ä (true)
        // –°—Ç–∞—Ä—É—Ö–∏ –Ω–∞—á–∏–Ω–∞—é—Ç —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞
        this.initializeExperience(1.5); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–ø—ã—Ç —Å –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º 1.5 (150% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞)
    }
    
    initializeExperience(multiplier) {
        Object.keys(this.experience).forEach(key => {
            this.experience[key] = Math.floor(30 + Math.random() * 50 * multiplier); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –æ–ø—ã—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–≤—ã–∫–∞ (30-80 * –º–Ω–æ–∂–∏—Ç–µ–ª—å)
        });
    }

    update() {
        // –°—Ç–∞—Ä—É—Ö–∞ –±—ã—Å—Ç—Ä–µ–µ —Ç–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ
        super.update(); // –í—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ update() —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞
        if (this.hunger > 60) {
            this.health -= 0.9; // –ü–æ—Ç–µ—Ä—è –∑–¥–æ—Ä–æ–≤—å—è —Å—Ç–∞—Ä—É—Ö–∏ –ø—Ä–∏ –≥–æ–ª–æ–¥–µ (0.9 –∑–∞ –∫–∞–¥—Ä, –±–æ–ª—å—à–µ —Ç–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ)
        }
        // –°—Ç–∞—Ä—É—Ö–∞ –±—ã—Å—Ç—Ä–µ–µ –∑–∞–º–µ—Ä–∑–∞–µ—Ç
        if (this.temperature < 35) {
            this.temperature -= 0.1; // –ü–æ—Ç–µ—Ä—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Å—Ç–∞—Ä—É—Ö–∏ –ø—Ä–∏ —Ö–æ–ª–æ–¥–µ (0.1¬∞C –∑–∞ –∫–∞–¥—Ä, —Ç–µ—Ä—è–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –±—ã—Å—Ç—Ä–µ–µ)
        }
    }
}

// –ö–ª–∞—Å—Å –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
class MiddleAgedMan extends Agent {
    constructor(name, age, type, ownerId = null) {
        super(name, age, 'male', type, ownerId); // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ Agent
        this.energy = 85; // –≠–Ω–µ—Ä–≥–∏—è –º—É–∂—á–∏–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (85)
        this.maxEnergy = 85; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –º—É–∂—á–∏–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (85)
        this.speed = 2; // –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –º—É–∂—á–∏–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (2 –ø–∏–∫—Å–µ–ª—è –∑–∞ –∫–∞–¥—Ä)
        this.maxHealth = 100; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –º—É–∂—á–∏–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (100)
        // –°—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç - —Å—Ä–µ–¥–Ω–∏–π –æ–ø—ã—Ç
        this.initializeExperience(0.5); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–ø—ã—Ç —Å –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º 0.5 (50% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞)
    }
    
    initializeExperience(multiplier) {
        Object.keys(this.experience).forEach(key => {
            this.experience[key] = Math.floor(10 + Math.random() * 30 * multiplier); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –æ–ø—ã—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–≤—ã–∫–∞ (10-40 * –º–Ω–æ–∂–∏—Ç–µ–ª—å)
        });
    }
}

class MiddleAgedWoman extends Agent {
    constructor(name, age, type, ownerId = null) {
        super(name, age, 'female', type, ownerId); // –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ Agent
        this.energy = 80; // –≠–Ω–µ—Ä–≥–∏—è –∂–µ–Ω—â–∏–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (80)
        this.maxEnergy = 80; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –∂–µ–Ω—â–∏–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (80)
        this.speed = 2; // –°–∫–æ—Ä–æ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –∂–µ–Ω—â–∏–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (2 –ø–∏–∫—Å–µ–ª—è –∑–∞ –∫–∞–¥—Ä)
        this.maxHealth = 100; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –∂–µ–Ω—â–∏–Ω—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞ (100)
        // –°—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç - —Å—Ä–µ–¥–Ω–∏–π –æ–ø—ã—Ç
        this.initializeExperience(0.5); // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–ø—ã—Ç —Å –º–Ω–æ–∂–∏—Ç–µ–ª–µ–º 0.5 (50% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –æ–ø—ã—Ç–∞)
    }
    
    initializeExperience(multiplier) {
        Object.keys(this.experience).forEach(key => {
            this.experience[key] = Math.floor(10 + Math.random() * 30 * multiplier); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –æ–ø—ã—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–≤—ã–∫–∞ (10-40 * –º–Ω–æ–∂–∏—Ç–µ–ª—å)
        });
    }
}

class AgentsManager {
    constructor(playerId = null) {
        this.agents = []; // –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ (–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ Agent)
        this.playerId = playerId; // ID —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ (—Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ null)
        this.initializeAgents();
    }

    initializeAgents(playerId = null) {
        // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω playerId, —Å–æ–∑–¥–∞–µ–º —Å–µ–º—å—é –¥–ª—è —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞
        if (playerId) {
            this.playerId = playerId; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º ID –∏–≥—Ä–æ–∫–∞
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è 6 –∞–≥–µ–Ω—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–æ—á–µ—Ä–Ω–∏—Ö –∫–ª–∞—Å—Å–æ–≤
        // –ï—Å–ª–∏ –µ—Å—Ç—å playerId, –≤—Å–µ –∞–≥–µ–Ω—Ç—ã –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —ç—Ç–æ–º—É –∏–≥—Ä–æ–∫—É
        this.agents = [
            new MiddleAgedMan('–ú—É–∂—á–∏–Ω–∞', 35, 'man', this.playerId),        // –ú—É–∂—á–∏–Ω–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞
            new MiddleAgedWoman('–ñ–µ–Ω—â–∏–Ω–∞', 32, 'woman', this.playerId),    // –ñ–µ–Ω—â–∏–Ω–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞
            new YoungMan('–ü–∞—Ä–µ–Ω—å', 18, 'boy', this.playerId),             // –ú–æ–ª–æ–¥–æ–π –ø–∞—Ä–µ–Ω—å
            new YoungWoman('–î–µ–≤—É—à–∫–∞', 17, 'girl', this.playerId),          // –ú–æ–ª–æ–¥–∞—è –¥–µ–≤—É—à–∫–∞
            new OldMan('–°—Ç–∞—Ä–∏–∫', 68, 'oldman', this.playerId),             // –°—Ç–∞—Ä–∏–∫
            new OldWoman('–°—Ç–∞—Ä—É—Ö–∞', 65, 'oldwoman', this.playerId)        // –°—Ç–∞—Ä—É—Ö–∞
        ];
    }
    
    // –ü–æ–ª—É—á–∏—Ç—å –∞–≥–µ–Ω—Ç–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
    getPlayerAgents() {
        if (!this.playerId) return []; // –ï—Å–ª–∏ –Ω–µ—Ç ID –∏–≥—Ä–æ–∫–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
        return this.agents.filter(agent => agent.ownerId === this.playerId); // –§–∏–ª—å—Ç—Ä—É–µ–º –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ ownerId
    }
    
    // –ü–æ–ª—É—á–∏—Ç—å –∞–≥–µ–Ω—Ç–∞ –ø–æ ID
    getAgentById(agentId) {
        return this.agents.find(agent => agent.id === agentId); // –ù–∞—Ö–æ–¥–∏–º –∞–≥–µ–Ω—Ç–∞ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É ID (–æ–±—ä–µ–∫—Ç Agent –∏–ª–∏ undefined)
    }

    update() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
        this.agents.forEach(agent => {
            agent.update(); // –í—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ update() –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
        });
    }

    getAgent(type) {
        return this.agents.find(agent => agent.type === type); // –ù–∞—Ö–æ–¥–∏–º –∞–≥–µ–Ω—Ç–∞ –ø–æ —Ç–∏–ø—É (–æ–±—ä–µ–∫—Ç Agent –∏–ª–∏ undefined)
    }

    getAllAgents() {
        return this.agents; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –º–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
    }

    reset() {
        this.initializeAgents(); // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∞–≥–µ–Ω—Ç–æ–≤
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π –∞–≥–µ–Ω—Ç–æ–≤ –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞
        this.agents.forEach(agent => {
            agent.initializePosition(); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
        });
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –∞–≥–µ–Ω—Ç–∞
    updateAgentUI(agentType) {
        const agent = this.getAgent(agentType); // –ù–∞—Ö–æ–¥–∏–º –∞–≥–µ–Ω—Ç–∞ –ø–æ —Ç–∏–ø—É (–æ–±—ä–µ–∫—Ç Agent –∏–ª–∏ undefined)
        if (!agent) return;

        const agentItem = document.querySelector(`[data-agent="${agentType}"]`).closest('.agent-item'); // –≠–ª–µ–º–µ–Ω—Ç DOM –¥–ª—è –∞–≥–µ–Ω—Ç–∞ (HTMLElement –∏–ª–∏ null)
        if (agentItem) {
            const nameSpan = agentItem.querySelector('.agent-name'); // –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–º–µ–Ω–∏ (HTMLElement –∏–ª–∏ null)
            const ageSpan = agentItem.querySelector('.agent-age'); // –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞ (HTMLElement –∏–ª–∏ null)
            const stateSelect = agentItem.querySelector('.agent-state'); // –≠–ª–µ–º–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è (HTMLElement –∏–ª–∏ null)
            const psycheSelect = agentItem.querySelector('.agent-psyche'); // –≠–ª–µ–º–µ–Ω—Ç –≤—ã–±–æ—Ä–∞ –ø—Å–∏—Ö–∏–∫–∏ (HTMLElement –∏–ª–∏ null)
            const energySlider = agentItem.querySelector('.agent-energy'); // –°–ª–∞–π–¥–µ—Ä —ç–Ω–µ—Ä–≥–∏–∏ (HTMLElement –∏–ª–∏ null)
            const energyValue = agentItem.querySelector('.energy-value'); // –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ (HTMLElement –∏–ª–∏ null)
            const hungerSlider = agentItem.querySelector('.agent-hunger'); // –°–ª–∞–π–¥–µ—Ä –≥–æ–ª–æ–¥–∞ (HTMLElement –∏–ª–∏ null)
            const hungerValue = agentItem.querySelector('.hunger-value'); // –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –≥–æ–ª–æ–¥–∞ (HTMLElement –∏–ª–∏ null)
            const statusSpan = agentItem.querySelector('.agent-status'); // –≠–ª–µ–º–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ (HTMLElement –∏–ª–∏ null)

            if (nameSpan) nameSpan.textContent = agent.name;
            if (ageSpan) ageSpan.textContent = agent.age;
            if (stateSelect) {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–¥–æ—Ä–æ–≤—å—è
                const healthState = agent.health > 70 ? 'healthy' :  // –ó–¥–æ—Ä–æ–≤ (–∑–¥–æ—Ä–æ–≤—å–µ > 70)
                                  agent.health > 40 ? 'wounded' : 'sick'; // –†–∞–Ω–µ–Ω (–∑–¥–æ—Ä–æ–≤—å–µ 40-70) –∏–ª–∏ –ë–æ–ª–µ–Ω (–∑–¥–æ—Ä–æ–≤—å–µ < 40)
                stateSelect.value = healthState; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            }
            if (psycheSelect) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Å–∏—Ö–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
                const psycheState = agent.mood === 'neutral' ? 'calm' :  // –°–ø–æ–∫–æ–µ–Ω (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ)
                                   agent.mood === 'anxious' ? 'tense' : 'panic'; // –ù–∞–ø—Ä—è–∂–µ–Ω (—Ç—Ä–µ–≤–æ–∂–Ω–æ–µ) –∏–ª–∏ –ü–∞–Ω–∏–∫–∞
                psycheSelect.value = psycheState; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Å–∏—Ö–∏–∫–∏
            }
            if (energySlider) {
                energySlider.value = Math.floor(agent.energy);
                if (energyValue) energyValue.textContent = Math.floor(agent.energy);
            }
            if (hungerSlider) {
                hungerSlider.value = Math.floor(agent.hunger);
                if (hungerValue) hungerValue.textContent = Math.floor(agent.hunger);
            }
            if (statusSpan) statusSpan.textContent = agent.getStateName();
        }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
    updateAllAgentsUI() {
        this.agents.forEach(agent => {
            this.updateAgentUI(agent.type);
        });
    }
}

// –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∞–≥–µ–Ω—Ç–æ–≤
const agents = new AgentsManager(); // –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∞–≥–µ–Ω—Ç–æ–≤ (–æ–±—ä–µ–∫—Ç AgentsManager)
window.agents = agents; // –î–µ–ª–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–º —á–µ—Ä–µ–∑ window –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ —Å—Ç–∞—Ä—ã–º –∫–æ–¥–æ–º
