# План миграции на модульную структуру

## Текущий статус

✅ Создана базовая структура каталогов
✅ Создан реестр предметов (ItemRegistry)
✅ Создана базовая структура миров
✅ Создана базовая структура агентов
✅ Создана базовая структура сети

## Что нужно сделать

### Этап 1: Перенос кода в модули (текущий этап)

1. **Агенты** (`src/agents/`)
   - [ ] Перенести всю логику из `agents.js` в модули
   - [ ] Разделить на: Agent.js, AgentTypes.js, AgentBehaviors.js
   - [ ] Вынести команды в отдельные модули

2. **Мир** (`src/worlds/`)
   - [ ] Перенести всю логику отрисовки из `world.js`
   - [ ] Разделить на: World.js, DefaultWorld.js, WorldRenderer.js
   - [ ] Вынести обработку событий в WorldInput.js

3. **Предметы** (`src/items/`)
   - [x] Создан ItemRegistry.js
   - [ ] Добавить категории предметов
   - [ ] Создать классы для каждого типа предмета

4. **UI** (`src/ui/`)
   - [ ] Вынести панели в отдельные модули
   - [ ] Создать компоненты для кнопок, форм
   - [ ] Вынести админ-панель в отдельный модуль

5. **Сеть** (`src/network/`)
   - [x] Создан NetworkManager.js
   - [ ] Перенести всю логику из network.js

### Этап 2: Обновление точки входа

1. Обновить `index.html` для использования ES modules
2. Создать `main.js` как точку входа, которая импортирует модули
3. Обновить все импорты

### Этап 3: Тестирование

1. Проверить работу всех модулей
2. Убедиться, что ничего не сломалось
3. Протестировать на мобильных устройствах

## Преимущества новой структуры

1. **Легко добавлять новые миры**: просто создайте новый класс в `src/worlds/`
2. **Легко добавлять предметы**: добавьте в `ItemRegistry.js`
3. **Легко добавлять типы агентов**: создайте новый класс в `AgentTypes.js`
4. **Модульность**: каждый компонент независим
5. **Тестируемость**: каждый модуль можно тестировать отдельно

## Примеры использования

### Добавление нового мира

```javascript
// src/worlds/DesertWorld.js
import { World } from './World.js';

export class DesertWorld extends World {
    generateTerrain() {
        // Генерация пустынного мира
    }
}
```

### Добавление нового предмета

```javascript
// В src/items/ItemRegistry.js
export const ITEMS = {
    tools: {
        // ... существующие
        newTool: {
            id: 'newTool',
            name: 'Новый инструмент',
            category: 'tool',
            skill: 'building'
        }
    }
};
```

### Добавление нового типа агента

```javascript
// src/agents/AgentTypes.js
export class Child extends Agent {
    constructor(name, age, type, ownerId = null) {
        super(name, age, 'neutral', type, ownerId);
        // Настройки ребенка
    }
}
```
